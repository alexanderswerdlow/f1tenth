<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>local_planner: local_planner.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">local_planner.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="local__planner_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;ros/ros.h&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;ros/message_operations.h&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;ros/message.h&quot;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;geometry_msgs/Twist.h&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;geometry_msgs/Vector3.h&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;geometry_msgs/Pose.h&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;geometry_msgs/Point.h&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;geometry_msgs/Transform.h&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;std_msgs/Empty.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;std_msgs/String.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;std_msgs/Float64.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;sensor_msgs/Imu.h&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;sensor_msgs/LaserScan.h&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;nav_msgs/Odometry.h&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;visualization_msgs/Marker.h&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;Eigen/Core&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;Eigen/Geometry&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;tf/tf.h&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;tf/transform_datatypes.h&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;tf/transform_listener.h&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;tf/transform_broadcaster.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;tf_conversions/tf_eigen.h&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;message_filters/subscriber.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;message_filters/synchronizer.h&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;message_filters/sync_policies/approximate_time.h&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;ros/callback_queue.h&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;Eigen/Eigen&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;Eigen/Dense&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a598a3330b3c21701223ee0ca14316eca">   35</a></span>&#160;<span class="preprocessor">#define PI 3.14159265</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a2f80386f2f64ce19285c9e4244fd05ee">   37</a></span>&#160;<span class="preprocessor">#define max_robot_curvature 0.4                                            // curvature=1/turning_radius*****</span></div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#aa2bd94909649b162eb2e7efd31f69726">   38</a></span>&#160;<span class="preprocessor">#define max_robot_velocity 1                                            // robot=husky</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a4555ba73cef1e7b84d531c6b14b4a3d6">   39</a></span>&#160;<span class="preprocessor">#define road_width 11.0</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ade3842146bb00113fe377d267b283887">   41</a></span>&#160;<span class="preprocessor">#define robot_length 1</span></div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a0ab0af80b5f27b877b3e3a1509bdecff">   42</a></span>&#160;<span class="preprocessor">#define robot_width 0.7</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a7a46c3b47347327490825236ffbd4304">   43</a></span>&#160;<span class="preprocessor">#define robot_radius 0.61</span></div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#adc155c0e4afe686a5f25c7ba8d01e913">   44</a></span>&#160;<span class="preprocessor">#define max_deviation ((road_width/2)-robot_width)                        // according to road_width and robot_width, the max deviation from the center line possible for the robot</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a18664faefb17400b465a3a21051f922e">   46</a></span>&#160;<span class="preprocessor">#define cl_curve_scaling 4</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a781b99a6d9fefd69ab171d5a11b5c641">   47</a></span>&#160;<span class="preprocessor">#define cl_straight_scale 200</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a2f33a93de7f5b3d170771dba8157d46a">   48</a></span>&#160;<span class="preprocessor">#define cl_dt 0.01                                                        // for t=0 to 1 in bezier curve we want 100 points per section (200=2bezier curve)</span></div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#adb04cfabf03f76c57530d4677d886d15">   49</a></span>&#160;<span class="preprocessor">#define cl_way_pt_no 3                                                // change this when changing no of waypoints</span></div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">   50</a></span>&#160;<span class="preprocessor">#define    cl_traj_pt ((cl_way_pt_no-2)*2/(cl_dt*cl_curve_scaling) + (cl_way_pt_no -1)*cl_straight_scale - 1)</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#adf21bae2e38f5d307dfee0be0a4d7340">   52</a></span>&#160;<span class="preprocessor">#define vs1_var 10</span></div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#abc05df855ddc66c6c6c6b92f28ca12a1">   53</a></span>&#160;<span class="preprocessor">#define d1_var 30                                                        // change for number of trajectories</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a356dc4a0a15cbd180a43cb6bd6db4433">   55</a></span>&#160;<span class="preprocessor">#define traj_time_div 200                                                // each traj divided in 200 small time scaled divisions</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a58b266028d86225355409f607b437902">   57</a></span>&#160;<span class="preprocessor">#define set_loop_rate 50                                                // ros loop_rate</span></div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a51907f76c1d1b4db1d09d501e4d9633e">   58</a></span>&#160;<span class="preprocessor">#define replanning_freq 2</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a9de9b418493fd4f66c91d8ab931ad477">   61</a></span>&#160;<span class="preprocessor">#define safety_clearance 0.3</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ac5e9d55d8f2ce48db1da6d095e09b6e9">   62</a></span>&#160;<span class="preprocessor">#define traj_s1 10</span></div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a6a7fd21f7bc340bbb4e04c514e536683">   63</a></span>&#160;<span class="preprocessor">#define traj_t1 10</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">using</span> Eigen::MatrixXd;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">using</span> Eigen::VectorXd;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceEigen.html">Eigen</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a1efafe64d92c5d256cd7124fd681a836">   71</a></span>&#160;ros::Publisher <a class="code" href="local__planner_8cpp.html#a1efafe64d92c5d256cd7124fd681a836">velocity_pub</a>;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#afb1d2a91a6dd407bd6a80859febf512e">   72</a></span>&#160;ros::Publisher <a class="code" href="local__planner_8cpp.html#afb1d2a91a6dd407bd6a80859febf512e">vis_pub</a>;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">   73</a></span>&#160;sensor_msgs::Imu <a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">   74</a></span>&#160;nav_msgs::Odometry <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>;</div><div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ad873ba305d44946ee75409224584033e">   75</a></span>&#160;nav_msgs::Odometry <a class="code" href="local__planner_8cpp.html#ad873ba305d44946ee75409224584033e">temp_pose_msg</a>;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">   76</a></span>&#160;geometry_msgs::Twist <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>;</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">   77</a></span>&#160;sensor_msgs::LaserScan <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">   80</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>;</div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a90bc79e319d8220cc2009aaa45241183">   81</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a>[100], <a class="code" href="local__planner_8cpp.html#a1748550d0030d6dbe5f7522171f4c06d">obstacle_local_angle</a>[100], <a class="code" href="local__planner_8cpp.html#a90bc79e319d8220cc2009aaa45241183">obstacle_radius</a>[100];</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a3d218019699439982d2661040d0106ca">   84</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a> = 0, <a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, <a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a> = 0, <a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, <a class="code" href="local__planner_8cpp.html#a68e0d3aaf643ea37de6e743cc0d04296">vs0</a> = 0, <a class="code" href="local__planner_8cpp.html#a3d218019699439982d2661040d0106ca">vs1</a>, <a class="code" href="local__planner_8cpp.html#aff0fb1a480bc0760f5f17155bef9b250">as0</a> = 0, <a class="code" href="local__planner_8cpp.html#a7f06f872d793c750223d5259fc3d49ed">as1</a>, <a class="code" href="local__planner_8cpp.html#ad59b5ced5ff0c0b46657b0fcaf1596b7">d0</a> = 0, <a class="code" href="local__planner_8cpp.html#a4e8c301f990fd72fe87a6d928bcfd60a">d1</a>, <a class="code" href="local__planner_8cpp.html#a7472b1780d9c3201ab1aa86ff5d34542">vd0</a> = 0, <a class="code" href="local__planner_8cpp.html#a2e01fee1e60f4e09b54edd80db24d8a8">vd1</a>, <a class="code" href="local__planner_8cpp.html#a82d9994945d41efd81d87e48cb163195">ad0</a> = 0,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="local__planner_8cpp.html#ad6d95303034671dc736a4bc1f27dd035">ad1</a>;              </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">   88</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#addef6f87b5a64ce67827031398bc1071">robot_current_x</a>, <a class="code" href="local__planner_8cpp.html#a8c6450fd8fb5527af2c098cf4ea0f71d">robot_current_y</a>, <a class="code" href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">robot_current_yaw</a>;                 </div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ac9d71ed62568c755562280c59cb04ae2">   89</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#ac9d71ed62568c755562280c59cb04ae2">robot_current_s</a>, <a class="code" href="local__planner_8cpp.html#a627702d2f23682cfec7940631a5bc9fb">robot_current_d</a>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">   92</a></span>&#160;Vector2d <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[<a class="code" href="local__planner_8cpp.html#adb04cfabf03f76c57530d4677d886d15">cl_way_pt_no</a>];                                                    </div><div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">   93</a></span>&#160;Vector2d <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[(int) <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>];        </div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">   94</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[(int) (<a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>)], <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[(int) (<a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>)], <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[(int) (<a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>)];</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a9ea6848b334fd0251ad7adc896668f86">   97</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="local__planner_8cpp.html#a9ea6848b334fd0251ad7adc896668f86">optimum_traj_no</a>;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a72b5c8c91d6a8dde0e0cf67b7e061796">   98</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#a011254dbae78503c6db39c3e40357639">global_velocity</a>[(int) <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>], <a class="code" href="local__planner_8cpp.html#a4c5705f992c466f8c0b7168ecb27c104">global_omega</a>[(<span class="keywordtype">int</span>) <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>], <a class="code" href="local__planner_8cpp.html#a4c8219ede1ade27a41eef17179b45fdc">global_theta_x</a>[(<span class="keywordtype">int</span>) cl_traj_pt], <a class="code" href="local__planner_8cpp.html#af9ba9a97f48fb0bb471b75929c93866d">global_x</a>[(<span class="keywordtype">int</span>) cl_traj_pt],</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="local__planner_8cpp.html#a72b5c8c91d6a8dde0e0cf67b7e061796">global_y</a>[(<span class="keywordtype">int</span>) cl_traj_pt];</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a9a2c88df8693626f0136f6181e63eea1">  100</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#a9a2c88df8693626f0136f6181e63eea1">exec_t_step</a>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">  102</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> = 0, <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a> = 50;</div><div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">  103</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a> = 0, <a class="code" href="local__planner_8cpp.html#aa4f3e8cdd84772718af1bb4b180ab348">last_plan</a> = 0;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a9368d13cc3c87efd4d03d834c60ee869">  104</a></span>&#160;<span class="keywordtype">long</span> <span class="keywordtype">int</span> <a class="code" href="local__planner_8cpp.html#a9368d13cc3c87efd4d03d834c60ee869">planning_instant</a> = 0;</div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a4d4afce9a47092986794487862ec7de9">  105</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#a4d4afce9a47092986794487862ec7de9">prev_global_theta_x</a> = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classobstacle.html">  107</a></span>&#160;class <a class="code" href="classobstacle.html">obstacle</a> {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classobstacle.html#a74686cda8e6308255dc0d4e8ee6e3594">  111</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classobstacle.html#a74686cda8e6308255dc0d4e8ee6e3594">obs_counter</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classobstacle.html#a9ab8279f395a82eed17ea20976cd19bb">  113</a></span>&#160;  <span class="keywordtype">double</span> transformed_x, transformed_y, center_s, center_d, clearing_radius, velocity, orientation, <a class="code" href="classobstacle.html#a9ab8279f395a82eed17ea20976cd19bb">vs</a>, vd;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classobstacle.html#a35e495dba687ff53be20bfe1ddac57a6">  115</a></span>&#160;  <a class="code" href="classobstacle.html#a35e495dba687ff53be20bfe1ddac57a6">obstacle</a>() {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        obs_counter++;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;};</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keywordtype">int</span> <a class="code" href="classobstacle.html#a74686cda8e6308255dc0d4e8ee6e3594">obstacle::obs_counter</a> = 0;                                      </div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a235458d2aeaae922a1288e53cba76953">  120</a></span>&#160;<a class="code" href="classobstacle.html">obstacle</a> <a class="code" href="local__planner_8cpp.html#a235458d2aeaae922a1288e53cba76953">obs</a>[100];</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classsd__traj.html">  122</a></span>&#160;<span class="keyword">class </span><a class="code" href="classsd__traj.html">sd_traj</a> {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; <span class="keyword">public</span>:</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">  125</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">traj_counter</a>;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classsd__traj.html#af37e4caff69fab3384170eacefa9df99">  127</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, <a class="code" href="classsd__traj.html#af37e4caff69fab3384170eacefa9df99">t1</a>;  <span class="comment">//s0,vs0,as0,  d0,vd0,ad0,  t1,  s1,vs1,as1,  d1,vd1,ad1;</span></div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classsd__traj.html#a8240ad9000f59ccc9f6b270db19a74d2">  128</a></span>&#160;  MatrixXd a_mat, b_mat, c_a_mat, <a class="code" href="classsd__traj.html#a8240ad9000f59ccc9f6b270db19a74d2">c_b_mat</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classsd__traj.html#afd326744d3573055c439650ddffd614b">  130</a></span>&#160;  <span class="keywordtype">double</span> cost, <a class="code" href="classsd__traj.html#afd326744d3573055c439650ddffd614b">max_curvature_value</a>;</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classsd__traj.html#a1e36520042478700368a302660e1f62e">  131</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classsd__traj.html#a1e36520042478700368a302660e1f62e">max_curvature_status</a>, collision_status;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classsd__traj.html#a5161707d715d7008c43ceb8db33d3324">  133</a></span>&#160;  <span class="keywordtype">double</span> st[200], ds[200];</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classsd__traj.html#a7ba21b8b04333e71516e64c7efb65cfc">  135</a></span>&#160;  <a class="code" href="classsd__traj.html#a7ba21b8b04333e71516e64c7efb65cfc">sd_traj</a>() : a_mat(6, 1), b_mat(6, 1), c_a_mat(6, 1), c_b_mat(6, 1) {                        </div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        traj_counter++;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;};</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keywordtype">int</span> <a class="code" href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">sd_traj::traj_counter</a> = 0;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a7daa551a0ff87c801434a361661ab18a">  141</a></span>&#160;<a class="code" href="classsd__traj.html">sd_traj</a> <a class="code" href="local__planner_8cpp.html#a7daa551a0ff87c801434a361661ab18a">traj</a>[<a class="code" href="local__planner_8cpp.html#adf21bae2e38f5d307dfee0be0a4d7340">vs1_var</a> * <a class="code" href="local__planner_8cpp.html#abc05df855ddc66c6c6c6b92f28ca12a1">d1_var</a>];                                    </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a8cde6b75086d15fe95bef8b3a991a552">  147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a8cde6b75086d15fe95bef8b3a991a552">imu_callback</a>(<span class="keyword">const</span> sensor_msgs::Imu::ConstPtr &amp;imu_msg) {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>.header = imu_msg-&gt;header;                                                </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>.angular_velocity = imu_msg-&gt;angular_velocity;                            </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>.linear_acceleration = imu_msg-&gt;linear_acceleration;                        </div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">//ROS_INFO(&quot;imu_updated&quot;);</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a6491a7e652ea9b773cad384904a81f4c">  154</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a6491a7e652ea9b773cad384904a81f4c">odom_scan_callback</a>(<span class="keyword">const</span> nav_msgs::Odometry::ConstPtr &amp;odom_msg, <span class="keyword">const</span> sensor_msgs::LaserScan::ConstPtr &amp;scan_msg) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  tf::Transform baselink2odom, obs2odom, point2;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.header = odom_msg-&gt;header;                                                    </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.position = odom_msg-&gt;pose.pose.position;                            </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.orientation = odom_msg-&gt;pose.pose.orientation;                    </div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.twist.twist.linear = odom_msg-&gt;twist.twist.linear;                            </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.twist.twist.angular = odom_msg-&gt;twist.twist.angular;                        </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  tf::poseMsgToTF(odom_msg-&gt;pose.pose, baselink2odom);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">// ROS_INFO(&quot;Seq: [%d]&quot;, odom_msg-&gt;header.seq);</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// ROS_INFO(&quot;Position-&gt; x: [%f], y: [%f], z: [%f]&quot;, odom_msg-&gt;pose.pose.position.x,msg-&gt;pose.pose.position.y, msg-&gt;pose.pose.position.z);</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// ROS_INFO(&quot;Orientation-&gt; x: [%f], y: [%f], z: [%f], w: [%f]&quot;, odom_msg-&gt;pose.pose.orientation.x, msg-&gt;pose.pose.orientation.y, msg-&gt;pose.pose.orientation.z, msg-&gt;pose.pose.orientation.w);</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="comment">// ROS_INFO(&quot;Vel-&gt; Linear: [%f], Angular: [%f]&quot;, odom_msg-&gt;twist.twist.linear.x,msg-&gt;twist.twist.angular.z);</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.header = scan_msg-&gt;header;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.angle_min = scan_msg-&gt;angle_min;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.angle_max = scan_msg-&gt;angle_max;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.angle_increment = scan_msg-&gt;angle_increment;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.range_min = scan_msg-&gt;range_min;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.range_max = scan_msg-&gt;range_max;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.ranges = scan_msg-&gt;ranges;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> = -1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">float</span> i = <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.angle_min, temp_distance = 0, temp_angle = 0, delta_angle = 0, prev_angle = 0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordtype">int</span> j = 0, prev_j = 0, count = 0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordflow">while</span> (i &lt; <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.angle_max) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.ranges[j] &gt;= <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.range_min) &amp;&amp; (<a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.ranges[j] &lt;= <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.range_max)) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <span class="keywordflow">if</span> (abs(j - prev_j) &gt; 90) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>++;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="comment">//ROS_INFO(&quot;obs_no = %d&quot;,obs_no);</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                prev_j = j;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> &gt; 0) {</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                  <span class="comment">//ROS_INFO(&quot;current-angle %lf&quot;,i);</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> - 1] = temp_distance / count;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a1748550d0030d6dbe5f7522171f4c06d">obstacle_local_angle</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> - 1] = (-temp_angle) / count;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a90bc79e319d8220cc2009aaa45241183">obstacle_radius</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> - 1] = (<a class="code" href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> - 1] * (delta_angle) / 2);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                  <span class="comment">//ROS_INFO(&quot;obs(%d) local_distance = %lf local_angle = %lf radius = %lf&quot;, obs_no-1,obstacle_local_distance[obs_no-1], obstacle_local_angle[obs_no-1], obstacle_radius[obs_no-1]);</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                temp_distance = 0;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                temp_angle = 0;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                count = 0;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                prev_angle = i;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="comment">//ROS_INFO(&quot;initial angle %lf&quot;,delta_angle);</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          temp_distance += <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.ranges[j];</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          temp_angle += i;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          count++;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          delta_angle = i - prev_angle;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        j++;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        i += <a class="code" href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a>.angle_increment;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>] = temp_distance / count;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="local__planner_8cpp.html#a1748550d0030d6dbe5f7522171f4c06d">obstacle_local_angle</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>] = (-temp_angle) / count;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="local__planner_8cpp.html#a90bc79e319d8220cc2009aaa45241183">obstacle_radius</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>] = (<a class="code" href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a>[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>] * (delta_angle) / 2);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">//ROS_INFO(&quot;obs(%d) local_distance = %lf local_angle = %lf radius = %lf&quot;, obs_no,obstacle_local_distance[obs_no], obstacle_local_angle[obs_no],obstacle_radius[obs_no]);</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="comment">//ROS_INFO(&quot;end&quot;);</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>; i++) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        tf::Vector3 V(<a class="code" href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a>[i] * cos(<a class="code" href="local__planner_8cpp.html#a1748550d0030d6dbe5f7522171f4c06d">obstacle_local_angle</a>[i]), <a class="code" href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a>[i] * sin(<a class="code" href="local__planner_8cpp.html#a1748550d0030d6dbe5f7522171f4c06d">obstacle_local_angle</a>[i]), 0);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        point2.setOrigin(V);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        obs2odom = baselink2odom * point2;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        obs[i].<a class="code" href="classobstacle.html#a59d16623cad9abb1fa5d2b34c7ec9d38">transformed_x</a> = obs2odom.getOrigin().x();</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        obs[i].<a class="code" href="classobstacle.html#a7189cf6ca75ab95b4ded044234935293">transformed_y</a> = obs2odom.getOrigin().y();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        obs[i].<a class="code" href="classobstacle.html#a6f8cc4a17c0f5f244160c2bd92a9eb7c">velocity</a> = 0;        </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        obs[i].<a class="code" href="classobstacle.html#a0d5fa2a59e2634782fa6e2021a769d33">orientation</a> = 0;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">//obs[i].vs = obs[i].vd = 0</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">// obs[i].vs = (sqrt(pow(pose_msg.twist.twist.linear.x,2) + pow(pose_msg.twist.twist.linear.y,2))) * cos(theta_r[prev_cl_pt] - obs[j].orientation);</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">// obs[i].vd = -(sqrt(pow(pose_msg.twist.twist.linear.x,2) + pow(pose_msg.twist.twist.linear.y,2))) * sin(theta_r[prev_cl_pt] - obs[j].orientation);</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#af4bb5f2901e6819e873fcbae218e14ee">  251</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#af4bb5f2901e6819e873fcbae218e14ee">publish_vw</a>(<span class="keywordtype">int</span> x) {</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">//cout&lt;&lt;x&lt;&lt;endl;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">//if((x &lt; (sizeof(global_velocity)/sizeof(global_velocity[0]))) &amp;&amp; (!stop_replanning))</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (x &lt; 0) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.x = (double) <a class="code" href="local__planner_8cpp.html#aa2bd94909649b162eb2e7efd31f69726">max_robot_velocity</a> / 2;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.y = 0;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.z = 0;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.x = 0;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.y = 0;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.z = 0;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <a class="code" href="local__planner_8cpp.html#a1efafe64d92c5d256cd7124fd681a836">velocity_pub</a>.publish(<a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        printf(<span class="stringliteral">&quot;velocity = %lf \n&quot;</span>, <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.x);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a>) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          <span class="comment">// double query_time = x/(double)set_loop_rate;</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <span class="comment">// double query_index = query_time/exec_t_step;                   /////////// (x/loop_rate) will be between 2 timesteps of index*exec_t_step</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;          <span class="comment">// double index_time_1 = floor(query_index)*exec_t_step;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          <span class="comment">// double index_time_2 = ceil(query_index)*exec_t_step;</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="comment">// cout&lt;&lt;&quot;query_time=&quot;&lt;&lt;query_time&lt;&lt;&quot; query_index=&quot;&lt;&lt;query_index&lt;&lt;&quot; index_time1=&quot;&lt;&lt;index_time_1&lt;&lt;&quot; index_time2=&quot;&lt;&lt;index_time_2&lt;&lt;endl;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <span class="comment">// cout&lt;&lt;&quot;global_velocity1=&quot;&lt;&lt;global_velocity[(int)floor(query_index)]&lt;&lt;&quot; global_velocity2=&quot;&lt;&lt;global_velocity[(int)ceil(query_index)]&lt;&lt;endl;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          <span class="comment">// cout&lt;&lt;&quot;global_omega1=&quot;&lt;&lt;global_omega[(int)floor(query_index)]&lt;&lt;&quot; global_omega2=&quot;&lt;&lt;global_omega[(int)ceil(query_index)]&lt;&lt;endl;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="comment">// double final_velocity = ((index_time_2 - query_time)*global_velocity[(int)floor(query_index)] + (query_time-index_time_1)*global_velocity[(int)ceil(query_index)])/(index_time_2 - index_time_1) ;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="comment">// double final_omega = ((index_time_2 - query_time)*global_omega[(int)floor(query_index)] + (query_time-index_time_1)*global_omega[(int)ceil(query_index)])/(index_time_2 - index_time_1) ;</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          <span class="keywordtype">double</span> query_index = (x / (double) <a class="code" href="local__planner_8cpp.html#a58b266028d86225355409f607b437902">set_loop_rate</a>)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                  / <a class="code" href="local__planner_8cpp.html#a9a2c88df8693626f0136f6181e63eea1">exec_t_step</a>;                   </div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;          <span class="keywordtype">double</span> final_velocity = ((ceil(query_index) - query_index) * <a class="code" href="local__planner_8cpp.html#a011254dbae78503c6db39c3e40357639">global_velocity</a>[(<span class="keywordtype">int</span>) floor(query_index)]</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                  + (query_index - floor(query_index)) * <a class="code" href="local__planner_8cpp.html#a011254dbae78503c6db39c3e40357639">global_velocity</a>[(<span class="keywordtype">int</span>) ceil(query_index)]) / (ceil(query_index) - floor(query_index));</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;          <span class="keywordtype">double</span> final_omega = ((ceil(query_index) - query_index) * <a class="code" href="local__planner_8cpp.html#a4c5705f992c466f8c0b7168ecb27c104">global_omega</a>[(<span class="keywordtype">int</span>) floor(query_index)]</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                  + (query_index - floor(query_index)) * <a class="code" href="local__planner_8cpp.html#a4c5705f992c466f8c0b7168ecb27c104">global_omega</a>[(<span class="keywordtype">int</span>) ceil(query_index)]) / (ceil(query_index) - floor(query_index));</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.x = final_velocity;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.y = 0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.z = 0;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.x = 0;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.y = 0;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.z = final_omega;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <span class="comment">//prev_global_theta_x = global_theta_x[x];</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <span class="comment">//printf(&quot;z = %d velocity = %lf , omega = %lf, global_theta_x = %lf \n&quot;, x,velocity_msg.linear.x, velocity_msg.angular.z, global_theta_x[x]);</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          <a class="code" href="local__planner_8cpp.html#a1efafe64d92c5d256cd7124fd681a836">velocity_pub</a>.publish(<a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <span class="keywordflow">if</span> (ceil(query_index) &gt;= <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                <a class="code" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a> = 1;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;stopped planning&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;          }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.x = 0;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.y = 0;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.linear.z = 0;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.x = 0;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.y = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;          <a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>.angular.z = 0;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          <a class="code" href="local__planner_8cpp.html#a1efafe64d92c5d256cd7124fd681a836">velocity_pub</a>.publish(<a class="code" href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a> || <a class="code" href="local__planner_8cpp.html#aa4f3e8cdd84772718af1bb4b180ab348">last_plan</a>)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                ros::shutdown();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a919dc6c875b86427c935889488d8f2db">  327</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a919dc6c875b86427c935889488d8f2db">get_global_waypoints</a>() {</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[0] &lt;&lt; 0, 0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[1] &lt;&lt; 42, 0;                                                </div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[2] &lt;&lt; 42, -45;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">// cl_way_pt[3] &lt;&lt;  10, 30;</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">// cl_way_pt[4] &lt;&lt;  40, 30;</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// cl_way_pt[5] &lt;&lt;  60, 10;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#aa56aa030d301a1554479ec5b232fd6a4">  338</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#aa56aa030d301a1554479ec5b232fd6a4">get_center_line_test</a>() {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#aa191aa5ac56db5aa289e6e9289b6c043">  342</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#aa191aa5ac56db5aa289e6e9289b6c043">get_center_line</a>() {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;no of cl_pt = &quot;</span> &lt;&lt; <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a> &lt;&lt; endl;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// ofstream myfile;</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="comment">//    myfile.open (&quot;center_line_coordinates.txt&quot;);</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  Vector2d W1, W2, W3, U1, U2, Ud, B0, B1, B2, B3, E0, E1, E2, E3;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordtype">double</span> c1 = 7.2364, c2 = (sqrt(6) - 1) * 2 / 5, c3, kmax = <a class="code" href="local__planner_8cpp.html#a2f80386f2f64ce19285c9e4244fd05ee">max_robot_curvature</a>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">double</span> beta, gammaa, dk, hb, he, gb, ge, kb, ke;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">int</span> ways = <a class="code" href="local__planner_8cpp.html#adb04cfabf03f76c57530d4677d886d15">cl_way_pt_no</a>, traj_pt = 0;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  c3 = (c2 + 4) / (c1 + 6);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordtype">double</span> temp_slope1, temp_slope2;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">double</span> t = 0;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt] &lt;&lt; 0, 0;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  Vector2d temp_pos = <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt], temp_pos1;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  traj_pt++;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">while</span> (i &lt; (ways - 2)) {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">// W[0][0]= way_x[i]; W[0][1]= way_y[i];</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">// W[1][0]= way_x[i+1]; W[1][1]= way_y[i+1];</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">// W[2][0]= way_x[i+2]; W[2][1]= way_y[i+2];</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">// temp_slope1 = atan((cl_way_pt[i+1](1)-cl_way_pt[i](1))/(cl_way_pt[i+1](0)-cl_way_pt[i](0)));</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="comment">// temp_slope2 = atan((cl_way_pt[i+2](1)-cl_way_pt[i+1](1))/(cl_way_pt[i+2](0)-cl_way_pt[i+1](0)));</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        W1 = <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[i];</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        W2 = <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[i + 1];</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        W3 = <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[i + 2];</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">// W1 = cl_way_pt[1];</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="comment">// W2 = cl_way_pt[2];</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">// W3 = cl_way_pt[3];</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="comment">// //cout&lt;&lt;&quot; W1 &quot; &lt;&lt; W1 &lt;&lt;&quot; W2 &quot;&lt;&lt;W2 &lt;&lt;&quot; W3 &quot;&lt;&lt; W3&lt;&lt;endl;</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="comment">// temp_slope1 = atan((W2(1) - W1(1))/(W2(0) - W1(0)));</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">// temp_slope2 = atan((W3(1) - W2(1))/(W3(0) - W2(0)));</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">// //cout &lt;&lt; temp_slope1 &lt;&lt;&quot; &quot;&lt;&lt; temp_slope1&lt;&lt;endl;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// if (temp_slope1&lt;0)</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">//      temp_slope1=temp_slope1+PI;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// if (temp_slope2&lt;0)</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">//      temp_slope2=temp_slope2+PI;</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">// gammaa = fabs(temp_slope2 - temp_slope1);</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">// beta = gammaa/2;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        Vector3d MW21, MW32, gamma_cross_vector;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        MW21 &lt;&lt; (W2(0) - W1(0)), (W2(1) - W1(1)), (0);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        MW32 &lt;&lt; (W3(0) - W2(0)), (W3(1) - W2(1)), (0);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        gamma_cross_vector = MW21.cross(MW32);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        gammaa = asin((gamma_cross_vector.norm()) / (((W2 - W1).norm()) * (((W3 - W2).norm()))));</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        beta = (<a class="code" href="local__planner_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a> - gammaa) / 2;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span> (gammaa == 0)</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          beta = <a class="code" href="local__planner_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        dk = (pow(c2 + 4, 2) * sin(beta)) / (54 * c3 * kmax * pow(cos(beta), 2));</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        hb = he = c3 * dk;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        gb = ge = c2 * c3 * dk;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        kb = ke = (6 * c3 * cos(beta) * dk) / (c2 + 4);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="comment">//U1 = (W[1]-W[2])/(W[1].norm() * W[2].norm());</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">//U2 = (W[2]-W[3])/(W[2].norm() * W[3].norm());</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        U1 = (W1 - W2) / ((W1 - W2).norm());</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        U2 = (W3 - W2) / ((W3 - W2).norm());</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        B0 = W2 + dk * U1;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        B1 = B0 - gb * U1;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        B2 = B1 - hb * U1;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        E0 = W2 + dk * U2;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        E1 = E0 - ge * U2;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        E2 = E1 - he * U2;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        Ud = (E2 - B2) / ((E2 - B2).norm());</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        B3 = B2 + kb * Ud;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        E3 = E2 - ke * Ud;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">// cout &lt;&lt; &quot;Here is the vector B0:\n&quot; &lt;&lt; B[0] &lt;&lt; endl;</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">// cout &lt;&lt; &quot;Here is the vector B1:\n&quot; &lt;&lt; B[1] &lt;&lt; endl;</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="comment">// cout &lt;&lt; &quot;Here is the vector B2:\n&quot; &lt;&lt; B[2] &lt;&lt; endl;</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        temp_pos1 = (pow(1 - t, 3) * B0 + 3 * pow(1 - t, 2) * t * B1 + 3 * (1 - t) * pow(t, 2) * B2 + pow(t, 3) * B3);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;temp_pos1 &quot;&lt;&lt;temp_pos1&lt;&lt;endl;</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="comment">//if(traj_pt==1)</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <span class="keywordflow">if</span> ((temp_pos1 - temp_pos).norm() &gt; 0.2) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                Vector2d temp_step = (temp_pos1 - temp_pos) / <a class="code" href="local__planner_8cpp.html#a781b99a6d9fefd69ab171d5a11b5c641">cl_straight_scale</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="local__planner_8cpp.html#a781b99a6d9fefd69ab171d5a11b5c641">cl_straight_scale</a> - 1;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                         x++)                                                            </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                {</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt] = <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt - 1] + temp_step;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                  <span class="comment">//cout &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                  <span class="comment">//myfile &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                  traj_pt++;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">while</span> (t &lt;= 1) {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;          <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt] = (pow(1 - t, 3) * B0 + 3 * pow(1 - t, 2) * t * B1 + 3 * (1 - t) * pow(t, 2) * B2 + pow(t, 3) * B3);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          <span class="comment">//cout &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;          <span class="comment">//myfile &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;          traj_pt++;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          t += <a class="code" href="local__planner_8cpp.html#a2f33a93de7f5b3d170771dba8157d46a">cl_dt</a> * <a class="code" href="local__planner_8cpp.html#a18664faefb17400b465a3a21051f922e">cl_curve_scaling</a>;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordflow">while</span> (t &gt;= 0) {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt] = (pow(1 - t, 3) * E0 + 3 * pow(1 - t, 2) * t * E1 + 3 * (1 - t) * pow(t, 2) * E2 + pow(t, 3) * E3);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          <span class="comment">//cout &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          <span class="comment">//myfile &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;          traj_pt++;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          t -= <a class="code" href="local__planner_8cpp.html#a2f33a93de7f5b3d170771dba8157d46a">cl_dt</a> * <a class="code" href="local__planner_8cpp.html#a18664faefb17400b465a3a21051f922e">cl_curve_scaling</a>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        temp_pos = <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt - 1];</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">//cout &lt;&lt; &quot;temp_pos &quot; &lt;&lt;temp_pos&lt;&lt;endl;</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        i++;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  temp_pos1 = <a class="code" href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a>[<a class="code" href="local__planner_8cpp.html#adb04cfabf03f76c57530d4677d886d15">cl_way_pt_no</a> - 1];</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">//cout&lt;&lt;&quot;temp_pos1 &quot;&lt;&lt;temp_pos1&lt;&lt;endl;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">//if(traj_pt==1)</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span> ((temp_pos1 - temp_pos).norm() &gt; 0.2) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          Vector2d temp_step = (temp_pos1 - temp_pos) / <a class="code" href="local__planner_8cpp.html#a781b99a6d9fefd69ab171d5a11b5c641">cl_straight_scale</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="local__planner_8cpp.html#a781b99a6d9fefd69ab171d5a11b5c641">cl_straight_scale</a>; x++) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt] = <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[traj_pt - 1] + temp_step;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                <span class="comment">//cout &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="comment">//myfile &lt;&lt;cl_way_traj[traj_pt](0)&lt;&lt;&quot; &quot;&lt;&lt;cl_way_traj[traj_pt](1)&lt;&lt; endl;</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                traj_pt++;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[0] = atan((<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[1](1) - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[0](1)) / (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[1](0) - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[0](0)));</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[0] = (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[1] - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[0]).norm();</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a> - 1; j++) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[j] = atan((<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j + 1](1) - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j](1)) / (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j + 1](0) - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j](0)));</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[j] = <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[j - 1] + (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j + 1] - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j]).norm();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[j - 1] = (<a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[j] - <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[j - 1]) / (<a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[j] - <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[j - 1]);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">// cout&lt;&lt;&quot;theta_r(&quot; &lt;&lt;(j) &lt;&lt; &quot;) = &quot; &lt;&lt; theta_r[j]&lt;&lt;endl;</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="comment">// cout&lt;&lt;&quot;arc_length(&quot; &lt;&lt;(j) &lt;&lt; &quot;) = &quot; &lt;&lt; arc_length[j]&lt;&lt;endl;</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">// cout&lt;&lt;&quot;kappa(&quot; &lt;&lt;(j-1) &lt;&lt; &quot;) = &quot; &lt;&lt; kappa[j-1]&lt;&lt; &quot;\n&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[(int) cl_traj_pt - 1] = <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[(<span class="keywordtype">int</span>) cl_traj_pt - 2];</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[(int) cl_traj_pt - 1] = <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[(<span class="keywordtype">int</span>) cl_traj_pt - 2];</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[(int) cl_traj_pt - 1] = <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[(<span class="keywordtype">int</span>) cl_traj_pt - 2] = <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[(int) cl_traj_pt - 3];</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;theta_r(&quot; &lt;&lt;(int)cl_traj_pt-1 &lt;&lt; &quot;) = &quot; &lt;&lt; theta_r[(int)cl_traj_pt-1]&lt;&lt;endl;</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;arc_length(&quot; &lt;&lt;(int)cl_traj_pt-1 &lt;&lt; &quot;) = &quot; &lt;&lt; arc_length[(int)cl_traj_pt-1]&lt;&lt;endl;</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;kappa(&quot; &lt;&lt;(int)cl_traj_pt-1 &lt;&lt; &quot;) = &quot; &lt;&lt; kappa[(int)cl_traj_pt-1]&lt;&lt; &quot;\n&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">//myfile.close();</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;}</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a1d37c710aae6c108f6ce2e40bf4df2f4">  540</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a1d37c710aae6c108f6ce2e40bf4df2f4">get_current_statedata</a>() {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">//extern obstacle obs[obs_no];</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  count++;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordtype">double</span> s_dot, s_dot_dot, d_dot, d_dot_dot;    </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordtype">double</span> d_dash, d_dash_dash;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">//      double robot_current_s,robot_current_d;</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  tf::Quaternion q(<a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.orientation.x,</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                   <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.orientation.y,</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                   <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.orientation.z,</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                   <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.orientation.w);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  tf::Matrix3x3 m(q);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordtype">double</span> roll, pitch, yaw;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  m.getRPY(roll, pitch, yaw);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;Roll: &quot; &lt;&lt; roll &lt;&lt; &quot;, Pitch: &quot; &lt;&lt; pitch &lt;&lt; &quot;, Yaw: &quot; &lt;&lt; yaw &lt;&lt; std::endl;</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <a class="code" href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">robot_current_yaw</a> = yaw;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <a class="code" href="local__planner_8cpp.html#addef6f87b5a64ce67827031398bc1071">robot_current_x</a> = <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.position.x;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <a class="code" href="local__planner_8cpp.html#a8c6450fd8fb5527af2c098cf4ea0f71d">robot_current_y</a> = <a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.pose.pose.position.y;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">//prev_cl_pt = 0;</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  Vector2d robot_current_pos;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  robot_current_pos &lt;&lt; <a class="code" href="local__planner_8cpp.html#addef6f87b5a64ce67827031398bc1071">robot_current_x</a>, <a class="code" href="local__planner_8cpp.html#a8c6450fd8fb5527af2c098cf4ea0f71d">robot_current_y</a>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordtype">double</span> temp_distance, lowest_distance = 1000, <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a> = 0;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordtype">int</span> closest_pt_index;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>; i++) {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        temp_distance = (robot_current_pos - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[i]).norm();</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span> (temp_distance &lt; lowest_distance) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          lowest_distance = temp_distance;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;          closest_pt_index = i;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; closest_pt_index + 1; j++) {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a> = <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a> + (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j] - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j - 1]).norm();</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> = closest_pt_index;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <a class="code" href="local__planner_8cpp.html#ac9d71ed62568c755562280c59cb04ae2">robot_current_s</a> = <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">//global_delta_theta = prev_global_theta_x - theta_r[prev_cl_pt] ;</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  Vector3d cl_vector, cl2pose_vector, cross_vector;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  cl_vector &lt;&lt; (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + 1](0) - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> - 1](0)), (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + 1](1)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> - 1](1)), 0;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  cl2pose_vector &lt;&lt; (robot_current_x - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>](0)), (robot_current_y - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>](1)), 0;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  cross_vector = cl_vector.cross(cl2pose_vector);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordflow">if</span> (cross_vector(2) &gt;= 0)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <a class="code" href="local__planner_8cpp.html#a627702d2f23682cfec7940631a5bc9fb">robot_current_d</a> = lowest_distance;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="local__planner_8cpp.html#a627702d2f23682cfec7940631a5bc9fb">robot_current_d</a> = -lowest_distance;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> == cl_traj_pt - 2) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a> = 1;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;stopped planning&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">//printf(&quot;\nrobot current pose (x=%lf, y=%lf); (s=%lf, d=%lf) and previous center_line pt = %d \n&quot;,robot_current_x, robot_current_y, robot_current_s,robot_current_d,prev_cl_pt);</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  s_dot =</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          (sqrt(pow(<a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.twist.twist.linear.x, 2) + pow(<a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.twist.twist.linear.y, 2))) * cos(<a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>] - <a class="code" href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">robot_current_yaw</a>);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  d_dot =</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          -(sqrt(pow(<a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.twist.twist.linear.x, 2) + pow(<a class="code" href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a>.twist.twist.linear.y, 2))) * sin(<a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>] - <a class="code" href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">robot_current_yaw</a>);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  s_dot_dot = (sqrt(pow(<a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>.linear_acceleration.x, 2) + pow(<a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>.linear_acceleration.y, 2)))</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          * cos(<a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>] - <a class="code" href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">robot_current_yaw</a>);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  d_dot_dot = -(sqrt(pow(<a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>.linear_acceleration.x, 2) + pow(<a class="code" href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a>.linear_acceleration.y, 2)))</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;          * sin(<a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>] - <a class="code" href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">robot_current_yaw</a>);</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">//printf(&quot;d_dot=%lf  d_dot_dot=%lf \n&quot;,d_dot,d_dot_dot);</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  d_dash = s_dot / (d_dot);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  d_dash_dash = ((d_dot_dot) - d_dash * s_dot_dot) / (pow(s_dot, 2));</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="comment">//printf(&quot;d_dash=%lf  d_dash_dash=%lf \n&quot;,d_dash,d_dash_dash);</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span> (count == 1) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="comment">//ROS_INFO(&quot;jabddbakdsakjd&quot;);</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a> = 0;                    </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a> = 0;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="local__planner_8cpp.html#a68e0d3aaf643ea37de6e743cc0d04296">vs0</a> = 0;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="local__planner_8cpp.html#aff0fb1a480bc0760f5f17155bef9b250">as0</a> = 0;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <a class="code" href="local__planner_8cpp.html#ad59b5ced5ff0c0b46657b0fcaf1596b7">d0</a> = 0;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <a class="code" href="local__planner_8cpp.html#a7472b1780d9c3201ab1aa86ff5d34542">vd0</a> = 0;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <a class="code" href="local__planner_8cpp.html#a82d9994945d41efd81d87e48cb163195">ad0</a> = 0;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (count &lt; 240) {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="comment">//ROS_INFO(&quot;bababababba&quot;);</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a> = 0;                    </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a> = 0;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <a class="code" href="local__planner_8cpp.html#a68e0d3aaf643ea37de6e743cc0d04296">vs0</a> = s_dot;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <a class="code" href="local__planner_8cpp.html#aff0fb1a480bc0760f5f17155bef9b250">as0</a> = s_dot_dot;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <a class="code" href="local__planner_8cpp.html#ad59b5ced5ff0c0b46657b0fcaf1596b7">d0</a> = <a class="code" href="local__planner_8cpp.html#a627702d2f23682cfec7940631a5bc9fb">robot_current_d</a>;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <a class="code" href="local__planner_8cpp.html#a7472b1780d9c3201ab1aa86ff5d34542">vd0</a> = d_dot;<span class="comment">//d_dash;</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <a class="code" href="local__planner_8cpp.html#a82d9994945d41efd81d87e48cb163195">ad0</a> = d_dot_dot;<span class="comment">//d_dash_dash;</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="comment">//printf(&quot;current state data: vs0=%lf as0=%lf d0=%lf vd0=%lf ad0=%lf \n&quot;,vs0,as0,d0,vd0,ad0);</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a> = 0;                    </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a> = 0;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <a class="code" href="local__planner_8cpp.html#a68e0d3aaf643ea37de6e743cc0d04296">vs0</a> = s_dot;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <a class="code" href="local__planner_8cpp.html#aff0fb1a480bc0760f5f17155bef9b250">as0</a> = s_dot_dot;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <a class="code" href="local__planner_8cpp.html#ad59b5ced5ff0c0b46657b0fcaf1596b7">d0</a> = <a class="code" href="local__planner_8cpp.html#a627702d2f23682cfec7940631a5bc9fb">robot_current_d</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <a class="code" href="local__planner_8cpp.html#a7472b1780d9c3201ab1aa86ff5d34542">vd0</a> = d_dot;<span class="comment">//d_dash;</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <a class="code" href="local__planner_8cpp.html#a82d9994945d41efd81d87e48cb163195">ad0</a> = d_dot_dot;<span class="comment">//d_dash_dash;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="comment">//printf(&quot;current state data: vs0=%lf as0=%lf d0=%lf vd0=%lf ad0=%lf \n&quot;,vs0,as0,d0,vd0,ad0);</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a12e0fd81e90cf833a5bf0ad90bb9b6c1">  667</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a12e0fd81e90cf833a5bf0ad90bb9b6c1">get_traj</a>() {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">// input: current_statedata, max_deviation, max_velocity varying sets of d1,vs1   &amp; t1,s1(optional for more sets &amp; optimality) </span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">//output: sets of sd_traj </span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">//ofstream myfile1;</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="comment">//myfile1.open (&quot;frenet_frame_traj_1.txt&quot;);</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  MatrixXd st_mat(6, 6), c_st_mat(6, 1), ds_mat(6, 6), c_ds_mat(6, 1);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordtype">int</span> traj_no = 0;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <a class="code" href="local__planner_8cpp.html#a7f06f872d793c750223d5259fc3d49ed">as1</a> = 0;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <a class="code" href="local__planner_8cpp.html#a2e01fee1e60f4e09b54edd80db24d8a8">vd1</a> = 0;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <a class="code" href="local__planner_8cpp.html#ad6d95303034671dc736a4bc1f27dd035">ad1</a> = 0;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a> = <a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a> + <a class="code" href="local__planner_8cpp.html#a6a7fd21f7bc340bbb4e04c514e536683">traj_t1</a>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a> = <a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a> + <a class="code" href="local__planner_8cpp.html#ac5e9d55d8f2ce48db1da6d095e09b6e9">traj_s1</a>;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  st_mat &lt;&lt; pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 5), pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 4), pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 3), pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 2), pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 1), 1,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;          pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 5), pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 4), pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 3), pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 2), pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 1), 1,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          5 * pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 4), 4 * pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 3), 3 * pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 2), 2 * pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 1), 1, 0,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          5 * pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 4), 4 * pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 3), 3 * pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 2), 2 * pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 1), 1, 0,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          20 * pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 3), 12 * pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 2), 6 * pow(<a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>, 1), 2, 0, 0,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          20 * pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 3), 12 * pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 2), 6 * pow(<a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>, 1), 2, 0, 0;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  ds_mat &lt;&lt; pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 5), pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 4), pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 3), pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 2), pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 1), 1,</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;          pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 5), pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 4), pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 3), pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 2), pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 1), 1,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          5 * pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 4), 4 * pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 3), 3 * pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 2), 2 * pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 1), 1, 0,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          5 * pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 4), 4 * pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 3), 3 * pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 2), 2 * pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 1), 1, 0,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          20 * pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 3), 12 * pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 2), 6 * pow(<a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>, 1), 2, 0, 0,</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          20 * pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 3), 12 * pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 2), 6 * pow(<a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>, 1), 2, 0, 0;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="comment">// int vs1_var=10, d1_var=10;                                                                                                         //////change for number of trajectories</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">// int traj_no=vs1_var*d1_var;</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="comment">// sd_traj traj[traj_no];</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">double</span> temp_vs1 = 0, temp_d1 = (double) <a class="code" href="local__planner_8cpp.html#adc155c0e4afe686a5f25c7ba8d01e913">max_deviation</a>, temp_t1, temp_s1;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <span class="keywordtype">double</span> vs1_step = (double) <a class="code" href="local__planner_8cpp.html#aa2bd94909649b162eb2e7efd31f69726">max_robot_velocity</a> / <a class="code" href="local__planner_8cpp.html#adf21bae2e38f5d307dfee0be0a4d7340">vs1_var</a>;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordtype">double</span> d1_step = (double) <a class="code" href="local__planner_8cpp.html#adc155c0e4afe686a5f25c7ba8d01e913">max_deviation</a> / (<a class="code" href="local__planner_8cpp.html#abc05df855ddc66c6c6c6b92f28ca12a1">d1_var</a> / 2);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">//cout&lt;&lt;&quot;deviation_step &quot; &lt;&lt;d1_step&lt;&lt;endl;</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="local__planner_8cpp.html#adf21bae2e38f5d307dfee0be0a4d7340">vs1_var</a>; i++) {</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        temp_vs1 = temp_vs1 + vs1_step;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="local__planner_8cpp.html#abc05df855ddc66c6c6c6b92f28ca12a1">d1_var</a>; j++) {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          temp_d1 = temp_d1 - d1_step;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          <span class="keywordflow">if</span> ((fabs(temp_d1)) &lt; 0.05)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                temp_d1 = 0;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;          c_st_mat &lt;&lt; <a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>,</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a>,</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a68e0d3aaf643ea37de6e743cc0d04296">vs0</a>,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                  temp_vs1,</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                  <a class="code" href="local__planner_8cpp.html#aff0fb1a480bc0760f5f17155bef9b250">as0</a>,</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a7f06f872d793c750223d5259fc3d49ed">as1</a>;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;          c_ds_mat &lt;&lt; <a class="code" href="local__planner_8cpp.html#ad59b5ced5ff0c0b46657b0fcaf1596b7">d0</a>,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                  temp_d1,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a7472b1780d9c3201ab1aa86ff5d34542">vd0</a>,</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a2e01fee1e60f4e09b54edd80db24d8a8">vd1</a>,</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a82d9994945d41efd81d87e48cb163195">ad0</a>,</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                  <a class="code" href="local__planner_8cpp.html#ad6d95303034671dc736a4bc1f27dd035">ad1</a>;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          traj[traj_no].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a> = st_mat.fullPivHouseholderQr().solve(c_st_mat);            <span class="comment">//colPivHouseholderQr()  llt()</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;          traj[traj_no].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a> = ds_mat.fullPivHouseholderQr().solve(c_ds_mat);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;          traj[traj_no].<a class="code" href="classsd__traj.html#a803e64316fb9b1c8943d6f1cf6cb8561">c_a_mat</a> = c_st_mat;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;          traj[traj_no].<a class="code" href="classsd__traj.html#a8240ad9000f59ccc9f6b270db19a74d2">c_b_mat</a> = c_ds_mat;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          traj[traj_no].<a class="code" href="classsd__traj.html#a17b0a342dc13f7c33880e897cefab877">t0</a> = <a class="code" href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;          traj[traj_no].<a class="code" href="classsd__traj.html#af37e4caff69fab3384170eacefa9df99">t1</a> = <a class="code" href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;\nst:\n&quot; &lt;&lt; st_mat &lt;&lt; endl;</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;\ncs:\n&quot; &lt;&lt; c_st_mat &lt;&lt; endl;</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;\na:\n&quot; &lt;&lt; traj[traj_no].a_mat.transpose() &lt;&lt; endl;</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;\nds:\n&quot; &lt;&lt; ds_mat &lt;&lt; endl;</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;\ncd:\n&quot; &lt;&lt; c_ds_mat &lt;&lt; endl;</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;\nb:\n&quot; &lt;&lt; traj[traj_no].b_mat.transpose() &lt;&lt; endl;</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          <span class="comment">//cout &lt;&lt;traj_no&lt;&lt;&quot; &quot;&lt;&lt;traj[traj_no].c_b_mat(1,0) &lt;&lt; endl;</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          <span class="comment">//myfile1 &lt;&lt;&quot;\n&quot;&lt;&lt; traj[traj_no].a_mat.transpose()&lt;&lt;endl ;</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;          <span class="comment">//myfile1 &lt;&lt;&quot;\n&quot;&lt;&lt; traj[traj_no].c_a_mat.transpose()&lt;&lt;endl ;</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          <span class="comment">//myfile1 &lt;&lt;&quot;\n&quot;&lt;&lt; traj[traj_no].b_mat.transpose()&lt;&lt;endl ;</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="comment">//myfile1 &lt;&lt;&quot;\n&quot;&lt;&lt; traj[traj_no].c_b_mat.transpose()&lt;&lt;endl ;</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          traj_no++;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        temp_d1 = (double) <a class="code" href="local__planner_8cpp.html#adc155c0e4afe686a5f25c7ba8d01e913">max_deviation</a>;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="comment">//break;</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="comment">//myfile1.close();</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <span class="comment">//cout&lt;&lt;sd_traj::traj_counter&lt;&lt;endl;</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#ab38a15ef1101eb9b7faea6ead4efa4e1">  765</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#ab38a15ef1101eb9b7faea6ead4efa4e1">get_obstacle_sd</a>() {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">//input: laser_data output: get obstacles from local laser frame to sd frame and their radius</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">//sample laser_data for non_zero values and get length and width of that obstacle</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">//then get center of obs in sdframe and clearing_radius (hypotenuse of lenth and width is diameter + husky_radius(0.6+0.2mclearance)) </span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">//closest point from center line(x,y) is s(t) and the deviation d(s) is perpendicular distance from that point </span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">//take only obstacles inside 10m distance </span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  Vector2d obs_global_center[<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a>];</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> + 1; x++) {</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        obs_global_center[x] &lt;&lt; obs[x].<a class="code" href="classobstacle.html#a59d16623cad9abb1fa5d2b34c7ec9d38">transformed_x</a>, obs[x].<a class="code" href="classobstacle.html#a7189cf6ca75ab95b4ded044234935293">transformed_y</a>;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        ROS_INFO(<span class="stringliteral">&quot;obsno%d x= %lf y= %lf&quot;</span>, x, obs_global_center[x](0), obs_global_center[x](1));</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordtype">double</span> temp_distance, lowest_distance = 1000, <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a> = 0;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordtype">int</span> closest_pt_index;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>; i &lt; <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>; i++) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;          temp_distance = (obs_global_center[x] - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[i]).norm();</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          <span class="keywordflow">if</span> (temp_distance &lt; lowest_distance) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                lowest_distance = temp_distance;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                closest_pt_index = i;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;          }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        }</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + 1; j &lt; closest_pt_index + 1; j++) {</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;          <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a> = <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a> + (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j] - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[j - 1]).norm();</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        Vector3d cl_vector, cl2pose_vector, cross_vector;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        cl_vector &lt;&lt; (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index + 1](0) - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index - 1](0)), (<a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index + 1](1)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index - 1](1)), 0;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        cl2pose_vector &lt;&lt; (obs_global_center[x](0) - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index](0)), (obs_global_center[x](1)</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                - <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index](1)), 0;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        cross_vector = cl_vector.cross(cl2pose_vector);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">if</span> (cross_vector(2) &gt;= 0)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;          obs[x].<a class="code" href="classobstacle.html#adf74bb0e3b4f7517504b80a43a5742b6">center_d</a> = lowest_distance;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;          obs[x].<a class="code" href="classobstacle.html#adf74bb0e3b4f7517504b80a43a5742b6">center_d</a> = -lowest_distance;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        obs[x].<a class="code" href="classobstacle.html#ae1111180c38a0319eb55a872555c17b3">center_s</a> = <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        obs[x].<a class="code" href="classobstacle.html#a3053259ff28d09af4706bce8fc894688">clearing_radius</a> = <a class="code" href="local__planner_8cpp.html#a90bc79e319d8220cc2009aaa45241183">obstacle_radius</a>[x] + (double) <a class="code" href="local__planner_8cpp.html#a7a46c3b47347327490825236ffbd4304">robot_radius</a> + <a class="code" href="local__planner_8cpp.html#a9de9b418493fd4f66c91d8ab931ad477">safety_clearance</a>;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;obstacle(&quot;</span> &lt;&lt; x + 1 &lt;&lt; <span class="stringliteral">&quot;) s,d = &quot;</span> &lt;&lt; obs[x].<a class="code" href="classobstacle.html#ae1111180c38a0319eb55a872555c17b3">center_s</a> &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; obs[x].<a class="code" href="classobstacle.html#adf74bb0e3b4f7517504b80a43a5742b6">center_d</a> &lt;&lt; <span class="stringliteral">&quot; radius = &quot;</span> &lt;&lt; obs[x].<a class="code" href="classobstacle.html#a3053259ff28d09af4706bce8fc894688">clearing_radius</a></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; and the closest point on center line = &quot;</span> &lt;&lt; <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index](0) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; <a class="code" href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a>[closest_pt_index](1)</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                 &lt;&lt; endl;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        obs[x].<a class="code" href="classobstacle.html#a9ab8279f395a82eed17ea20976cd19bb">vs</a> = obs[x].<a class="code" href="classobstacle.html#a9d51607bab73a6ad332ef4f9d8ce1a83">vd</a> = 0;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="comment">// obs[x].vs = (sqrt(pow(pose_msg.twist.twist.linear.x,2) + pow(pose_msg.twist.twist.linear.y,2))) * cos(theta_r[closest_pt_index] - obs[x].orientation);  </span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="comment">// obs[x].vd = -(sqrt(pow(pose_msg.twist.twist.linear.x,2) + pow(pose_msg.twist.twist.linear.y,2))) * sin(theta_r[closest_pt_index] - obs[x].orientation); </span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;}</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a5298273aac03e72f5f5c39a01e08aa5f">  831</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a5298273aac03e72f5f5c39a01e08aa5f">publish_marker_loop</a>() {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">int</span> temp = 0;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">sd_traj::traj_counter</a>; i++) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>; <span class="keywordtype">id</span>++) {</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          <span class="keywordtype">double</span> x = traj[i].<a class="code" href="classsd__traj.html#a5161707d715d7008c43ceb8db33d3324">st</a>[id];</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          <span class="keywordtype">double</span> y = traj[i].<a class="code" href="classsd__traj.html#adf22f8c8b4074ee21c09c43966d42cfb">ds</a>[id];</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;          visualization_msgs::Marker marker;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;          marker.header.frame_id = <span class="stringliteral">&quot;odom&quot;</span>;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          marker.header.stamp = ros::Time();</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;          marker.ns = <span class="stringliteral">&quot;my_namespace&quot;</span>;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;          marker.id = temp;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;          marker.type = visualization_msgs::Marker::SPHERE;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;          marker.action = visualization_msgs::Marker::ADD;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;          marker.pose.position.x = x;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;          marker.pose.position.y = y;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          marker.pose.position.z = 0;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;          marker.pose.orientation.x = 0.0;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;          marker.pose.orientation.y = 0.0;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;          marker.pose.orientation.z = 0.0;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;          marker.pose.orientation.w = 1.0;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;          marker.scale.x = 0.1;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;          marker.scale.y = 0.1;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;          marker.scale.z = 0.1;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;          marker.color.a = 1.0; <span class="comment">// Don&#39;t forget to set the alpha!</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          marker.color.r = 0.0;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;          marker.color.g = 1.0;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;          marker.color.b = 0.0;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          temp++;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          <span class="comment">//only if using a MESH_RESOURCE marker type:</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          <span class="comment">//marker.mesh_resource = &quot;package://pr2_description/meshes/base_v0/base.dae&quot;;</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <a class="code" href="local__planner_8cpp.html#afb1d2a91a6dd407bd6a80859febf512e">vis_pub</a>.publish(marker);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;          <span class="keywordtype">int</span> temp1 = 20000;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          <span class="keywordflow">while</span> (temp1--);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  }</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;}</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div><div class="line"><a name="l00872"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a6428add5b8abc398b62f2797db5f523f">  872</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a6428add5b8abc398b62f2797db5f523f">publish_marker</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  visualization_msgs::Marker marker;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  marker.header.frame_id = <span class="stringliteral">&quot;odom&quot;</span>;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  marker.header.stamp = ros::Time();</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  marker.ns = <span class="stringliteral">&quot;my_namespace&quot;</span>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  marker.id = id;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  marker.type = visualization_msgs::Marker::SPHERE;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  marker.action = visualization_msgs::Marker::ADD;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  marker.pose.position.x = x;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  marker.pose.position.y = y;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  marker.pose.position.z = 0;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  marker.pose.orientation.x = 0.0;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  marker.pose.orientation.y = 0.0;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  marker.pose.orientation.z = 0.0;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  marker.pose.orientation.w = 1.0;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  marker.scale.x = 0.1;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  marker.scale.y = 0.1;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  marker.scale.z = 0.1;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  marker.color.a = 1.0; <span class="comment">// Don&#39;t forget to set the alpha!</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  marker.color.r = 0.0;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  marker.color.g = 1.0;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  marker.color.b = 0.0;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="keywordtype">id</span>++;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="comment">//only if using a MESH_RESOURCE marker type:</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="comment">//marker.mesh_resource = &quot;package://pr2_description/meshes/base_v0/base.dae&quot;;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="local__planner_8cpp.html#afb1d2a91a6dd407bd6a80859febf512e">vis_pub</a>.publish(marker);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;}</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a5bc1b5031f5246c44954e0621b9273ab">  902</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#a5bc1b5031f5246c44954e0621b9273ab">check_collision</a>() {</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  <span class="comment">// ofstream myfile2;</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">// myfile2.open (&quot;traj_x_y_1.txt&quot;);</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordtype">double</span> t_div = <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordtype">int</span> temp_collision = 0;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">sd_traj::traj_counter</a>; i++) {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordtype">double</span> temp_T = 0, temp_D = 0;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordtype">double</span> obs_t_step = (traj[i].<a class="code" href="classsd__traj.html#af37e4caff69fab3384170eacefa9df99">t1</a> - traj[i].<a class="code" href="classsd__traj.html#a17b0a342dc13f7c33880e897cefab877">t0</a>) / t_div;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordtype">double</span> temp_st, temp_ds;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        traj[i].<a class="code" href="classsd__traj.html#a70115b2b35981b43cd74397e6fe26d66">collision_status</a> = 0;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i1 = 0; i1 &lt; t_div; i1++) {</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          temp_st = traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(0, 0) * pow(temp_T, 5) + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(1, 0) * pow(temp_T, 4) + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(2, 0) * pow(temp_T, 3)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                  + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(3, 0) * pow(temp_T, 2) +</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                  traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(4, 0) * temp_T + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(5, 0);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          temp_ds = traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(0, 0) * pow(temp_st, 5) + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(1, 0) * pow(temp_st, 4) + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(2, 0) * pow(temp_st, 3)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                  + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(3, 0) * pow(temp_st, 2) +</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                  traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(4, 0) * temp_st + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(5, 0);</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          traj[i].<a class="code" href="classsd__traj.html#a5161707d715d7008c43ceb8db33d3324">st</a>[i1] = temp_st;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          traj[i].<a class="code" href="classsd__traj.html#adf22f8c8b4074ee21c09c43966d42cfb">ds</a>[i1] = temp_ds;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          <span class="comment">//if(i1%10==0)</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;          <span class="comment">//publish_marker(temp_st,temp_ds);</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;          <span class="comment">//if(i==0)</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          <span class="comment">// {</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          <span class="comment">//myfile2 &lt;&lt;&quot;&quot;&lt;&lt; temp_st&lt;&lt;&quot; &quot;&lt;&lt; temp_ds&lt;&lt;&quot; &quot;&lt;&lt;i&lt;&lt;&quot; &quot;&lt;&lt;planning_instant&lt;&lt;endl ;</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;          <span class="comment">//    }</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> + 1; j++) {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                <span class="comment">// obs[j].transformed_x = obs[j].transformed_x + obs[j].velocity*cos(obs[j].orientation)*obs_t_step;</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                <span class="comment">// obs[j].transformed_y = obs[j].transformed_y + obs[j].velocity*sin(obs[j].orientation)*obs_t_step;</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                <span class="comment">// get_obstacle_sd();</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                <span class="comment">// obs[j].center_s = obs[j].center_s + obs[j].vs*obs_t_step;</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <span class="comment">// obs[j].center_d = obs[j].center_d + obs[j].vd*obs_t_step;</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                temp_D = pow(fabs(obs[j].center_s - temp_st), 2)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                        + pow(fabs(obs[j].center_d - temp_ds), 2);      </div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                <span class="comment">//cout&lt;&lt;&quot;distance = &quot;&lt;&lt;sqrt(temp_D) &lt;&lt; endl;</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                <span class="comment">//cout&lt;&lt; obs[j].clearing_radius &lt;&lt;&quot; radius&quot;&lt;&lt;   endl;</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                <span class="comment">//double temp_adu = sqrt(temp_D) - obs[j].clearing_radius ;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                <span class="comment">//static int adu_counter=0;</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                <span class="comment">//if((traj[i].c_b_mat(1,0)==0))</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                <span class="comment">//cout&lt;&lt;temp_adu&lt;&lt;&quot;    &quot;&lt;&lt;i&lt;&lt;&quot;  &quot;&lt;&lt;temp_ds&lt;&lt;&quot;  &quot;&lt;&lt;temp_st &lt;&lt;endl;</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">if</span> ((sqrt(temp_D)) - (obs[j].clearing_radius) &lt;= 0) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                  <span class="comment">//adu_counter++;</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                  traj[i].<a class="code" href="classsd__traj.html#a70115b2b35981b43cd74397e6fe26d66">collision_status</a> = 1;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                  <span class="comment">//cout &lt;&lt;&quot;traj &quot;&lt;&lt;i&lt;&lt; &quot; has collided and its deviation = &quot; &lt;&lt; traj[i].c_b_mat(1,0) &lt;&lt;endl;</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                  temp_collision++;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <span class="comment">// else</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="comment">// {</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <span class="comment">//      traj[i].collision_status = 0;</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                <span class="comment">//      //cout&lt;&lt;&quot;not collided &quot;&lt;&lt; i &lt;&lt;endl;</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                <span class="comment">// }</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">if</span> (traj[i].collision_status == 1)</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;          }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="keywordflow">if</span> (traj[i].collision_status == 1)</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;          temp_T = temp_T + obs_t_step;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">if</span> (temp_collision &gt;= <a class="code" href="local__planner_8cpp.html#adf21bae2e38f5d307dfee0be0a4d7340">vs1_var</a> * <a class="code" href="local__planner_8cpp.html#abc05df855ddc66c6c6c6b92f28ca12a1">d1_var</a>) {</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="comment">//stop_replanning=1;                                                  //////////////change this to see the issue</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;stopped planning-obs &quot;</span> &lt;&lt; temp_collision &lt;&lt; endl;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// for(int i=0; i&lt;sd_traj::traj_counter; i++)</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">// {cout &lt;&lt; &quot;collision of traj(&quot; &lt;&lt;i&lt;&lt; &quot;) = &quot; &lt;&lt; traj[i].collision_status &lt;&lt; &quot; and its deviation = &quot; &lt;&lt; traj[i].c_b_mat(1,0)&lt;&lt; endl;}</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="comment">//myfile2.close();</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;}</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a834d942b572ceb537c64d3ab9f55ccc6"> 1008</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="local__planner_8cpp.html#a834d942b572ceb537c64d3ab9f55ccc6">sort_low_cost</a>(<a class="code" href="classsd__traj.html">sd_traj</a> &amp;traj_a, <a class="code" href="classsd__traj.html">sd_traj</a> &amp;traj_b) {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">return</span> (traj_a.<a class="code" href="classsd__traj.html#af01db5acd09c4118711a0669fdb975d0">cost</a> &lt; traj_b.<a class="code" href="classsd__traj.html#af01db5acd09c4118711a0669fdb975d0">cost</a>);</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;}</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#acb4e26b36672e56fc305cfd20b772d2f"> 1012</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#acb4e26b36672e56fc305cfd20b772d2f">compute_cost</a>() {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="comment">//double kj_lon=0.001, kt_lon=1, ks_lon=0, kj_lat=0.0001, ks_lat=0.0001, kd_lat=20, k_lon=1, k_lat=1;                                                 // tune heuristics</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <span class="keywordtype">double</span> kj_lon = 2, kt_lon = 0, ks_lon = 0, kj_lat = 2, ks_lat = 0.0000, kd_lat = 10, kv_lon = -10;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordtype">double</span> k_lon = 1,</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          k_lat = 1;                                                                                                    <span class="comment">// tune heuristics</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">sd_traj::traj_counter</a>; i++) {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="keywordtype">double</span> cost_lon = 0, cost_lat = 0;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordflow">if</span> ((traj[i].collision_status == 0) || <a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> &lt; 0) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;          <span class="keywordtype">double</span> del_t = traj[i].<a class="code" href="classsd__traj.html#af37e4caff69fab3384170eacefa9df99">t1</a> - traj[i].<a class="code" href="classsd__traj.html#a17b0a342dc13f7c33880e897cefab877">t0</a>, del_s = traj[i].<a class="code" href="classsd__traj.html#a803e64316fb9b1c8943d6f1cf6cb8561">c_a_mat</a>(1, 0) - <a class="code" href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a>,</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                  v = traj[i].<a class="code" href="classsd__traj.html#a803e64316fb9b1c8943d6f1cf6cb8561">c_a_mat</a>(3, 0);                        </div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;          <span class="keywordtype">double</span> cost_jerklon =</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                  720 * (pow(traj[i].a_mat(0, 0), 2) * pow(del_t, 5)) + (720 * (traj[i].a_mat(0, 0) * traj[i].a_mat(1, 0)) * pow(del_t, 4)) +</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                          (240 * (traj[i].a_mat(0, 0) * traj[i].a_mat(2, 0)) + 192 * (pow(traj[i].a_mat(1, 0), 2))) * pow(del_t, 3)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                          + (144 * (traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(1, 0) * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(2, 0)) * pow(del_t, 2)) + +(36 * (pow(traj[i].a_mat(2, 0), 2) * del_t));</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;          cost_lon = kj_lon * cost_jerklon + kt_lon * del_t + ks_lon * pow(del_s, 2) + kv_lon * v;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;          <span class="keywordtype">double</span> cost_jerklat =</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                  720 * (pow(traj[i].b_mat(0, 0), 2) * pow(del_s, 5)) + (720 * (traj[i].b_mat(0, 0) * traj[i].b_mat(1, 0)) * pow(del_s, 4)) +</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                          (240 * (traj[i].b_mat(0, 0) * traj[i].b_mat(2, 0)) + 192 * (pow(traj[i].b_mat(1, 0), 2))) * pow(del_s, 3)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                          + (144 * (traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(1, 0) * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(2, 0)) * pow(del_s, 2)) + +(36 * (pow(traj[i].b_mat(2, 0), 2) * del_s));</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          cost_lat = kj_lat * cost_jerklat + ks_lat * del_s + kd_lat * pow((traj[i].c_b_mat(1, 0)), 2);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;          traj[i].<a class="code" href="classsd__traj.html#af01db5acd09c4118711a0669fdb975d0">cost</a> = k_lat * cost_lat + k_lon * cost_lon;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;cost of traj(&quot; &lt;&lt;i&lt;&lt; &quot;) = &quot; &lt;&lt; traj[i].cost &lt;&lt; &quot; and its deviation = &quot; &lt;&lt; traj[i].c_b_mat(1,0) &lt;&lt; endl;</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;          traj[i].<a class="code" href="classsd__traj.html#af01db5acd09c4118711a0669fdb975d0">cost</a> = 1000000;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        }</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  }</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="comment">//std::sort(traj, traj+sd_traj::traj_counter, [] (sd_traj&amp; traj_a, sd_traj&amp; traj_b) -&gt; bool { return (traj_a.cost &lt; traj_b.cost); });</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  std::sort(traj,</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        traj + sd_traj::traj_counter,</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                        <a class="code" href="local__planner_8cpp.html#a834d942b572ceb537c64d3ab9f55ccc6">sort_low_cost</a>);                                    </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="comment">// for(int i=0; i&lt;sd_traj::traj_counter; i++)</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="comment">// {cout &lt;&lt; &quot;cost of traj(&quot; &lt;&lt;i&lt;&lt; &quot;) = &quot; &lt;&lt; traj[i].cost &lt;&lt; &quot; and its deviation = &quot; &lt;&lt; traj[i].c_b_mat(1,0) &lt;&lt; endl;  }</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;}</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div><div class="line"><a name="l01068"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#aef8dc9d0b4c26170f6a0eda9862dc616"> 1068</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="local__planner_8cpp.html#aef8dc9d0b4c26170f6a0eda9862dc616">check_curvature_convert2vw</a>() {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  <span class="comment">//ofstream myfile3;</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  <span class="comment">//myfile3.open (&quot;final_traj.txt&quot;);</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a>) {</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">sd_traj::traj_counter</a>; i++) {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a> = 0;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;          <span class="keywordtype">double</span> temp_arclength = traj[i].<a class="code" href="classsd__traj.html#a803e64316fb9b1c8943d6f1cf6cb8561">c_a_mat</a>(0, 0);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          <span class="keywordflow">while</span> (temp_arclength &lt; traj[i].c_a_mat(1, 0)) {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                temp_arclength = temp_arclength + (<a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a> + 1] - <a class="code" href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>]);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>++;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;          }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;no of center_line points included &quot; &lt;&lt; cl_pt_indices &lt;&lt;&quot; and total arc_length is &quot; &lt;&lt; temp_arclength &lt;&lt; endl;</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a> + <a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>) &gt;= <a class="code" href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a>) {</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <a class="code" href="local__planner_8cpp.html#aa4f3e8cdd84772718af1bb4b180ab348">last_plan</a> = 1; <span class="comment">//stop_replanning=1;</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;lastplanning&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                <span class="keywordflow">return</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;          }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;          <span class="keywordtype">double</span> temp_T = 0;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;          <a class="code" href="local__planner_8cpp.html#a9a2c88df8693626f0136f6181e63eea1">exec_t_step</a> = (traj[i].<a class="code" href="classsd__traj.html#af37e4caff69fab3384170eacefa9df99">t1</a> - traj[i].<a class="code" href="classsd__traj.html#a17b0a342dc13f7c33880e897cefab877">t0</a>) / <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;          <span class="comment">//cout &lt;&lt; &quot;time_step = &quot;&lt;&lt;exec_t_step &lt;&lt;endl;</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          <span class="keywordtype">double</span> s[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>], d[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>], s_dot[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>], d_dash[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>], d_dot[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>],</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                  s_dot_dot[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>], d_dash_dash[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>], d_dot_dot[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>];</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;          <span class="keywordtype">double</span> del_theta[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>], final_kappa[<a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a> - 1];</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;          <span class="keywordtype">double</span> temp_a, temp_b;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;          traj[i].<a class="code" href="classsd__traj.html#a1e36520042478700368a302660e1f62e">max_curvature_status</a> = 0;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a>; k++) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                s[k] = traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(0, 0) * pow(temp_T, 5) + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(1, 0) * pow(temp_T, 4) + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(2, 0) * pow(temp_T, 3)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                        + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(3, 0) * pow(temp_T, 2) +</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                        traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(4, 0) * temp_T + traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(5, 0);</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                d[k] = traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(0, 0) * pow(s[k], 5) + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(1, 0) * pow(s[k], 4) + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(2, 0) * pow(s[k], 3)</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                        + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(3, 0) * pow(s[k], 2) +</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                        traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(4, 0) * s[k] + traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(5, 0);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                s_dot[k] =</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        5 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(0, 0) * pow(temp_T, 4) + 4 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(1, 0) * pow(temp_T, 3) + 3 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(2, 0) * pow(temp_T, 2)</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                                + 2 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(3, 0) * temp_T +</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                                traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(4, 0);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                d_dash[k] = 5 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(0, 0) * pow(s[k], 4) + 4 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(1, 0) * pow(s[k], 3) + 3 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(2, 0) * pow(s[k], 2)</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                        + 2 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(3, 0) * s[k] +</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                        traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(4, 0);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                d_dot[k] = s_dot[k] * d_dash[k];</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                s_dot_dot[k] =</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                        20 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(0, 0) * pow(temp_T, 3) + 12 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(1, 0) * pow(temp_T, 2) + 6 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(2, 0) * temp_T</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                + 2 * traj[i].<a class="code" href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">a_mat</a>(3, 0);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                d_dash_dash[k] = 20 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(0, 0) * pow(s[k], 3) + 12 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(1, 0) * pow(s[k], 2) + 6 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(2, 0) * s[k]</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                        + 2 * traj[i].<a class="code" href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">b_mat</a>(3, 0);</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                d_dot_dot[k] = d_dash_dash[k] * pow(s_dot[k], 2) + d_dash[k] * s_dot_dot[k];</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                <a class="code" href="local__planner_8cpp.html#a4c8219ede1ade27a41eef17179b45fdc">global_theta_x</a>[k] =</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                        <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k] + atan(d_dash[k] / (1 - <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k] * d[k]));                    </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                del_theta[k] = <a class="code" href="local__planner_8cpp.html#a4c8219ede1ade27a41eef17179b45fdc">global_theta_x</a>[k] - <a class="code" href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k];</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                <a class="code" href="local__planner_8cpp.html#a011254dbae78503c6db39c3e40357639">global_velocity</a>[k] = (1 - <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k] * d[k]) * s_dot[k] / cos(del_theta[k]);                </div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <span class="comment">//cout &lt;&lt; &quot;v = &quot;&lt;&lt;global_velocity[k] &lt;&lt; &quot; theta = &quot;&lt;&lt; global_theta_x[k] &lt;&lt;&quot; and traj &quot;&lt;&lt;i &lt;&lt; &quot; and point &quot;&lt;&lt; k&lt;&lt;endl;</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                <span class="comment">//cout&lt;&lt;&quot;haha &quot;&lt;&lt;k&lt;&lt;endl;</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                <span class="keywordflow">if</span> (k &gt; 0) {</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                  <a class="code" href="local__planner_8cpp.html#a4c5705f992c466f8c0b7168ecb27c104">global_omega</a>[k - 1] = (<a class="code" href="local__planner_8cpp.html#a4c8219ede1ade27a41eef17179b45fdc">global_theta_x</a>[k] - <a class="code" href="local__planner_8cpp.html#a4c8219ede1ade27a41eef17179b45fdc">global_theta_x</a>[k - 1]) / <a class="code" href="local__planner_8cpp.html#a9a2c88df8693626f0136f6181e63eea1">exec_t_step</a>;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                  temp_a = (<a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k] * d[k] - <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k - 1] * d[k - 1]) / (s[k] - s[k - 1]);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                  temp_b = ((d_dash_dash[k] + temp_a * tan(del_theta[k])) * (pow(cos(del_theta[k]), 2) / (1 - <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k] * d[k])))</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                          + <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k];</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                  final_kappa[k] = temp_b * (cos(del_theta[k]) / (1 - <a class="code" href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a>[<a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a> + k] * d[k]));</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                  <span class="comment">//cout&lt;&lt;&quot;haha &quot;&lt;&lt;k&lt;&lt;endl;</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                  <span class="comment">//cout&lt;&lt; &quot;final_kappa = &quot;&lt;&lt;final_kappa[k] &lt;&lt;endl;</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                  <span class="comment">//if ((final_kappa[k] &lt; -max_robot_curvature) || (final_kappa[k] &gt; max_robot_curvature))</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                  <span class="keywordflow">if</span> (fabs(final_kappa[k]) &gt; (<a class="code" href="local__planner_8cpp.html#a2f80386f2f64ce19285c9e4244fd05ee">max_robot_curvature</a> + 0.02)) {</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                        traj[i].<a class="code" href="classsd__traj.html#a1e36520042478700368a302660e1f62e">max_curvature_status</a> = 1;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                        cout &lt;&lt; <span class="stringliteral">&quot;curvature exceeded for traj:&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; and kappa_max = &quot;</span> &lt;&lt; fabs(final_kappa[k]) &lt;&lt; endl;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                        <span class="keywordflow">if</span> (i == (<a class="code" href="local__planner_8cpp.html#adf21bae2e38f5d307dfee0be0a4d7340">vs1_var</a> * <a class="code" href="local__planner_8cpp.html#abc05df855ddc66c6c6c6b92f28ca12a1">d1_var</a> - 1)) {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                          <a class="code" href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a> = 1;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                          cout &lt;&lt; <span class="stringliteral">&quot;stopped planning - curv&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                        }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                  } <span class="keywordflow">else</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                        traj[i].<a class="code" href="classsd__traj.html#a1e36520042478700368a302660e1f62e">max_curvature_status</a> = 0;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                  <span class="comment">// if(traj[i].max_curvature_status == 1)</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                  <span class="comment">// {</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                  <span class="comment">//    cout &lt;&lt; &quot;curvature exceeded for traj:&quot; &lt;&lt; i &lt;&lt; &quot; and kappa_max = &quot;&lt;&lt; fabs(final_kappa[k])&lt;&lt; endl;</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                  <span class="comment">//    if(i==(vs1_var*d1_var-1))</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                  <span class="comment">//    stop_replanning=1;</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                  <span class="comment">//    break;</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                  <span class="comment">// }</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                temp_T = temp_T + <a class="code" href="local__planner_8cpp.html#a9a2c88df8693626f0136f6181e63eea1">exec_t_step</a>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;          <span class="keywordflow">if</span> (traj[i].max_curvature_status == 0) {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <a class="code" href="local__planner_8cpp.html#a9ea6848b334fd0251ad7adc896668f86">optimum_traj_no</a> = i;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;optimum_traj= &quot;</span> &lt;&lt; <a class="code" href="local__planner_8cpp.html#a9ea6848b334fd0251ad7adc896668f86">optimum_traj_no</a> &lt;&lt; <span class="stringliteral">&quot;, deviation= &quot;</span> &lt;&lt; traj[<a class="code" href="local__planner_8cpp.html#a9ea6848b334fd0251ad7adc896668f86">optimum_traj_no</a>].<a class="code" href="classsd__traj.html#a8240ad9000f59ccc9f6b270db19a74d2">c_b_mat</a>(1, 0) &lt;&lt; <span class="stringliteral">&quot;, velocity= &quot;</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                         &lt;&lt; traj[<a class="code" href="local__planner_8cpp.html#a9ea6848b334fd0251ad7adc896668f86">optimum_traj_no</a>].<a class="code" href="classsd__traj.html#a803e64316fb9b1c8943d6f1cf6cb8561">c_a_mat</a>(3, 0) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                <span class="comment">// for (int l = 0; l &lt; cl_pt_indices; ++l)</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                <span class="comment">// {</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                <span class="comment">//              //myfile3 &lt;&lt; global_velocity[l] &lt;&lt;&quot; &quot; &lt;&lt; global_theta_x[l] &lt;&lt; endl;</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                <span class="comment">// }</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          }</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;          temp_T = 0;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        }</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="comment">// global_x[0] = robot_current_x; global_y[0] = robot_current_y;</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <span class="comment">// double exec_t_step = (traj[optimum_traj_no].t1 - traj[optimum_traj_no].t0)/cl_pt_indices;</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="comment">// for (int m = 1; m &lt; cl_pt_indices; m++)</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="comment">// {</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="comment">//      global_x[m] = global_x[m-1] + global_velocity[m-1]*cos(global_theta_x[m-1])*exec_t_step;</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <span class="comment">//      global_y[m] = global_y[m-1] + global_velocity[m-1]*sin(global_theta_x[m-1])*exec_t_step;                        </span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <span class="comment">//      //myfile3 &lt;&lt; global_x[m] &lt;&lt;&quot; &quot; &lt;&lt; global_y[m] &lt;&lt; endl;</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <span class="comment">// }</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">//myfile3.close();</span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;}</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">// void convert2worldxy()</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="comment">// {</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">//      global_x[0] = global_y[0] = 0;</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">//      double exec_t_step = (traj[optimum_traj_no].t1 - traj[optimum_traj_no].t0)/cl_traj_pt;</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">//      for (int m = 1; m &lt; cl_traj_pt; ++m)</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">//      {</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">//              global_x[m] = global_x[m-1] + global_velocity[m-1]*cos(global_theta_x[m-1])*exec_t_step;</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">//              global_y[m] = global_y[m-1] + global_velocity[m-1]*sin(global_theta_x[m-1])*exec_t_step;                        </span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">//      }</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment">// }</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"><a class="line" href="local__planner_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627"> 1233</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="local__planner_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  ros::init(argc, argv, <span class="stringliteral">&quot;local_planner&quot;</span>);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  ros::NodeHandle n;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  <span class="comment">//ros::Subscriber odom_sub = n.subscribe(&quot;/odometry/filtered&quot;, 1, odom_callback);</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="comment">//ros::Subscriber scan_sub = n.subscribe(&quot;/scan&quot;, 1, scan_callback );</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  ros::Subscriber imu_sub = n.subscribe(<span class="stringliteral">&quot;/imu&quot;</span>, 1, <a class="code" href="local__planner_8cpp.html#a8cde6b75086d15fe95bef8b3a991a552">imu_callback</a>);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  message_filters::Subscriber&lt;nav_msgs::Odometry&gt; odom_sub(n, <span class="stringliteral">&quot;/odometry/filtered&quot;</span>, 1);</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  message_filters::Subscriber&lt;sensor_msgs::LaserScan&gt; scan_sub(n, <span class="stringliteral">&quot;/scan&quot;</span>, 1);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keyword">typedef</span> message_filters::sync_policies::ApproximateTime&lt;nav_msgs::Odometry, sensor_msgs::LaserScan&gt; MySyncPolicy;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  message_filters::Synchronizer&lt;MySyncPolicy&gt; sync(MySyncPolicy(10), odom_sub, scan_sub);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  sync.registerCallback(boost::bind(&amp;<a class="code" href="local__planner_8cpp.html#a6491a7e652ea9b773cad384904a81f4c">odom_scan_callback</a>, _1, _2));</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <a class="code" href="local__planner_8cpp.html#a1efafe64d92c5d256cd7124fd681a836">velocity_pub</a> = n.advertise&lt;geometry_msgs::Twist&gt;(<span class="stringliteral">&quot;/cmd_vel&quot;</span>, 0);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <a class="code" href="local__planner_8cpp.html#afb1d2a91a6dd407bd6a80859febf512e">vis_pub</a> = n.advertise&lt;visualization_msgs::Marker&gt;(<span class="stringliteral">&quot;visualization_marker&quot;</span>, 2000000);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  ros::Rate loop_rate(<a class="code" href="local__planner_8cpp.html#a58b266028d86225355409f607b437902">set_loop_rate</a>);</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <a class="code" href="local__planner_8cpp.html#a919dc6c875b86427c935889488d8f2db">get_global_waypoints</a>();</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="local__planner_8cpp.html#aa191aa5ac56db5aa289e6e9289b6c043">get_center_line</a>();</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> w = 0; w &lt; 30000000; w++) {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        ros::spinOnce();</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">if</span> ((w % 1000000) == 0)</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;          <a class="code" href="local__planner_8cpp.html#af4bb5f2901e6819e873fcbae218e14ee">publish_vw</a>(-1);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  }</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">//clock_t tStart = clock();</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <a class="code" href="local__planner_8cpp.html#a1d37c710aae6c108f6ce2e40bf4df2f4">get_current_statedata</a>();</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <a class="code" href="local__planner_8cpp.html#a12e0fd81e90cf833a5bf0ad90bb9b6c1">get_traj</a>();</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> &gt;= 0) {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <a class="code" href="local__planner_8cpp.html#ab38a15ef1101eb9b7faea6ead4efa4e1">get_obstacle_sd</a>();</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <a class="code" href="local__planner_8cpp.html#a5bc1b5031f5246c44954e0621b9273ab">check_collision</a>();</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <a class="code" href="local__planner_8cpp.html#acb4e26b36672e56fc305cfd20b772d2f">compute_cost</a>();</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <a class="code" href="local__planner_8cpp.html#aef8dc9d0b4c26170f6a0eda9862dc616">check_curvature_convert2vw</a>();</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordtype">int</span> z = 0;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">//printf(&quot;Exec Time: %.2fs\n&quot;, (double)(clock() - tStart)/CLOCKS_PER_SEC);</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="comment">//publish_marker_loop();</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">while</span> (ros::ok()) {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <a class="code" href="local__planner_8cpp.html#a1d37c710aae6c108f6ce2e40bf4df2f4">get_current_statedata</a>();</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="keywordflow">if</span> ((z == (<span class="keywordtype">int</span>) (<a class="code" href="local__planner_8cpp.html#a58b266028d86225355409f607b437902">set_loop_rate</a> / <a class="code" href="local__planner_8cpp.html#a51907f76c1d1b4db1d09d501e4d9633e">replanning_freq</a>))) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;          printf(<span class="stringliteral">&quot;\nrobot current pose (x=%lf, y=%lf); (s=%lf, d=%lf) and previous center_line pt = %d \n&quot;</span>,</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                         <a class="code" href="local__planner_8cpp.html#addef6f87b5a64ce67827031398bc1071">robot_current_x</a>,</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                         <a class="code" href="local__planner_8cpp.html#a8c6450fd8fb5527af2c098cf4ea0f71d">robot_current_y</a>,</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                         <a class="code" href="local__planner_8cpp.html#ac9d71ed62568c755562280c59cb04ae2">robot_current_s</a>,</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                         <a class="code" href="local__planner_8cpp.html#a627702d2f23682cfec7940631a5bc9fb">robot_current_d</a>,</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                         <a class="code" href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a>);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          printf(<span class="stringliteral">&quot;current state data: vs0=%lf as0=%lf d0=%lf vd0=%lf ad0=%lf \n&quot;</span>, <a class="code" href="local__planner_8cpp.html#a68e0d3aaf643ea37de6e743cc0d04296">vs0</a>, <a class="code" href="local__planner_8cpp.html#aff0fb1a480bc0760f5f17155bef9b250">as0</a>, <a class="code" href="local__planner_8cpp.html#ad59b5ced5ff0c0b46657b0fcaf1596b7">d0</a>, <a class="code" href="local__planner_8cpp.html#a7472b1780d9c3201ab1aa86ff5d34542">vd0</a>, <a class="code" href="local__planner_8cpp.html#a82d9994945d41efd81d87e48cb163195">ad0</a>);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;          <span class="comment">//int y=0;</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;          <span class="comment">//clock_t tStart = clock();</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;          <span class="comment">//get_current_statedata();</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          <span class="comment">//y++; ROS_INFO(&quot;y = %d&quot;,y);</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;          <a class="code" href="local__planner_8cpp.html#a12e0fd81e90cf833a5bf0ad90bb9b6c1">get_traj</a>();</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          <span class="comment">//y++; ROS_INFO(&quot;y = %d&quot;,y);</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a> &gt;= 0) {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                <a class="code" href="local__planner_8cpp.html#ab38a15ef1101eb9b7faea6ead4efa4e1">get_obstacle_sd</a>();</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                <span class="comment">//y++; ROS_INFO(&quot;y = %d&quot;,y);</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                <a class="code" href="local__planner_8cpp.html#a5bc1b5031f5246c44954e0621b9273ab">check_collision</a>();</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                <span class="comment">//y++; ROS_INFO(&quot;y = %d&quot;,y);</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;          }</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;          <a class="code" href="local__planner_8cpp.html#acb4e26b36672e56fc305cfd20b772d2f">compute_cost</a>();</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          <span class="comment">//y++; ROS_INFO(&quot;y = %d&quot;,y);</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          <a class="code" href="local__planner_8cpp.html#aef8dc9d0b4c26170f6a0eda9862dc616">check_curvature_convert2vw</a>();</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;          <span class="comment">//y++; ROS_INFO(&quot;y = %d&quot;,y);</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="local__planner_8cpp.html#aa4f3e8cdd84772718af1bb4b180ab348">last_plan</a>)</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                z = 0;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;          <span class="comment">//printf(&quot;Exec Time: %.2fs\n&quot;, (double)(clock() - tStart)/CLOCKS_PER_SEC);</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;          <a class="code" href="local__planner_8cpp.html#a9368d13cc3c87efd4d03d834c60ee869">planning_instant</a>++;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <a class="code" href="local__planner_8cpp.html#af4bb5f2901e6819e873fcbae218e14ee">publish_vw</a>(z + 1);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        z++;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="comment">//ROS_INFO(&quot;z = %d&quot;,z);</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        <span class="comment">//if(!stop_replanning)</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="comment">//ros::shutdown();</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        ros::spinOnce();</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        loop_rate.sleep();</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  }</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;}</div><div class="ttc" id="classobstacle_html_a6f8cc4a17c0f5f244160c2bd92a9eb7c"><div class="ttname"><a href="classobstacle.html#a6f8cc4a17c0f5f244160c2bd92a9eb7c">obstacle::velocity</a></div><div class="ttdeci">double velocity</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a9de9b418493fd4f66c91d8ab931ad477"><div class="ttname"><a href="local__planner_8cpp.html#a9de9b418493fd4f66c91d8ab931ad477">safety_clearance</a></div><div class="ttdeci">#define safety_clearance</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00061">local_planner.cpp:61</a></div></div>
<div class="ttc" id="classsd__traj_html_af01db5acd09c4118711a0669fdb975d0"><div class="ttname"><a href="classsd__traj.html#af01db5acd09c4118711a0669fdb975d0">sd_traj::cost</a></div><div class="ttdeci">double cost</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00130">local_planner.cpp:130</a></div></div>
<div class="ttc" id="classsd__traj_html_a70115b2b35981b43cd74397e6fe26d66"><div class="ttname"><a href="classsd__traj.html#a70115b2b35981b43cd74397e6fe26d66">sd_traj::collision_status</a></div><div class="ttdeci">bool collision_status</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00131">local_planner.cpp:131</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_adb04cfabf03f76c57530d4677d886d15"><div class="ttname"><a href="local__planner_8cpp.html#adb04cfabf03f76c57530d4677d886d15">cl_way_pt_no</a></div><div class="ttdeci">#define cl_way_pt_no</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00049">local_planner.cpp:49</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_adc155c0e4afe686a5f25c7ba8d01e913"><div class="ttname"><a href="local__planner_8cpp.html#adc155c0e4afe686a5f25c7ba8d01e913">max_deviation</a></div><div class="ttdeci">#define max_deviation</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00044">local_planner.cpp:44</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a74af4a7e7a3e62af44c74a0c5c3fafca"><div class="ttname"><a href="local__planner_8cpp.html#a74af4a7e7a3e62af44c74a0c5c3fafca">prev_cl_pt</a></div><div class="ttdeci">int prev_cl_pt</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00102">local_planner.cpp:102</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a704e1a794bbe4344c9aaba66ff6442f3"><div class="ttname"><a href="local__planner_8cpp.html#a704e1a794bbe4344c9aaba66ff6442f3">stop_replanning</a></div><div class="ttdeci">bool stop_replanning</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00103">local_planner.cpp:103</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ae3c764d8e851d0c6f710cd4d734e7b3a"><div class="ttname"><a href="local__planner_8cpp.html#ae3c764d8e851d0c6f710cd4d734e7b3a">obs_msg</a></div><div class="ttdeci">sensor_msgs::LaserScan obs_msg</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00077">local_planner.cpp:77</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a6a7fd21f7bc340bbb4e04c514e536683"><div class="ttname"><a href="local__planner_8cpp.html#a6a7fd21f7bc340bbb4e04c514e536683">traj_t1</a></div><div class="ttdeci">#define traj_t1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00063">local_planner.cpp:63</a></div></div>
<div class="ttc" id="classobstacle_html"><div class="ttname"><a href="classobstacle.html">obstacle</a></div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00107">local_planner.cpp:107</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a12e0fd81e90cf833a5bf0ad90bb9b6c1"><div class="ttname"><a href="local__planner_8cpp.html#a12e0fd81e90cf833a5bf0ad90bb9b6c1">get_traj</a></div><div class="ttdeci">void get_traj()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00667">local_planner.cpp:667</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a82d9994945d41efd81d87e48cb163195"><div class="ttname"><a href="local__planner_8cpp.html#a82d9994945d41efd81d87e48cb163195">ad0</a></div><div class="ttdeci">double ad0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a9084bbdfe127c270421a1947a3287ed8"><div class="ttname"><a href="local__planner_8cpp.html#a9084bbdfe127c270421a1947a3287ed8">pose_msg</a></div><div class="ttdeci">nav_msgs::Odometry pose_msg</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00074">local_planner.cpp:74</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a1efafe64d92c5d256cd7124fd681a836"><div class="ttname"><a href="local__planner_8cpp.html#a1efafe64d92c5d256cd7124fd681a836">velocity_pub</a></div><div class="ttdeci">ros::Publisher velocity_pub</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00071">local_planner.cpp:71</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a3b1fdcc6d714df729ba26078d6ac6cbe"><div class="ttname"><a href="local__planner_8cpp.html#a3b1fdcc6d714df729ba26078d6ac6cbe">cl_way_traj</a></div><div class="ttdeci">Vector2d cl_way_traj[(int) cl_traj_pt]</div><div class="ttdoc">center line waypoints </div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00093">local_planner.cpp:93</a></div></div>
<div class="ttc" id="classsd__traj_html_a7ba21b8b04333e71516e64c7efb65cfc"><div class="ttname"><a href="classsd__traj.html#a7ba21b8b04333e71516e64c7efb65cfc">sd_traj::sd_traj</a></div><div class="ttdeci">sd_traj()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00135">local_planner.cpp:135</a></div></div>
<div class="ttc" id="classsd__traj_html_a803e64316fb9b1c8943d6f1cf6cb8561"><div class="ttname"><a href="classsd__traj.html#a803e64316fb9b1c8943d6f1cf6cb8561">sd_traj::c_a_mat</a></div><div class="ttdeci">MatrixXd c_a_mat</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00128">local_planner.cpp:128</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a011254dbae78503c6db39c3e40357639"><div class="ttname"><a href="local__planner_8cpp.html#a011254dbae78503c6db39c3e40357639">global_velocity</a></div><div class="ttdeci">double global_velocity[(int) cl_traj_pt]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00098">local_planner.cpp:98</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a6428add5b8abc398b62f2797db5f523f"><div class="ttname"><a href="local__planner_8cpp.html#a6428add5b8abc398b62f2797db5f523f">publish_marker</a></div><div class="ttdeci">void publish_marker(double x, double y)</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00872">local_planner.cpp:872</a></div></div>
<div class="ttc" id="classobstacle_html_a3053259ff28d09af4706bce8fc894688"><div class="ttname"><a href="classobstacle.html#a3053259ff28d09af4706bce8fc894688">obstacle::clearing_radius</a></div><div class="ttdeci">double clearing_radius</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a598a3330b3c21701223ee0ca14316eca"><div class="ttname"><a href="local__planner_8cpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a></div><div class="ttdeci">#define PI</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00035">local_planner.cpp:35</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a7a46c3b47347327490825236ffbd4304"><div class="ttname"><a href="local__planner_8cpp.html#a7a46c3b47347327490825236ffbd4304">robot_radius</a></div><div class="ttdeci">#define robot_radius</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00043">local_planner.cpp:43</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_adf21bae2e38f5d307dfee0be0a4d7340"><div class="ttname"><a href="local__planner_8cpp.html#adf21bae2e38f5d307dfee0be0a4d7340">vs1_var</a></div><div class="ttdeci">#define vs1_var</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00052">local_planner.cpp:52</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aa56aa030d301a1554479ec5b232fd6a4"><div class="ttname"><a href="local__planner_8cpp.html#aa56aa030d301a1554479ec5b232fd6a4">get_center_line_test</a></div><div class="ttdeci">void get_center_line_test()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00338">local_planner.cpp:338</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a9368d13cc3c87efd4d03d834c60ee869"><div class="ttname"><a href="local__planner_8cpp.html#a9368d13cc3c87efd4d03d834c60ee869">planning_instant</a></div><div class="ttdeci">long int planning_instant</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00104">local_planner.cpp:104</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_af9ba9a97f48fb0bb471b75929c93866d"><div class="ttname"><a href="local__planner_8cpp.html#af9ba9a97f48fb0bb471b75929c93866d">global_x</a></div><div class="ttdeci">double global_x[(int) cl_traj_pt]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00098">local_planner.cpp:98</a></div></div>
<div class="ttc" id="namespaceEigen_html"><div class="ttname"><a href="namespaceEigen.html">Eigen</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="classsd__traj_html_a17b0a342dc13f7c33880e897cefab877"><div class="ttname"><a href="classsd__traj.html#a17b0a342dc13f7c33880e897cefab877">sd_traj::t0</a></div><div class="ttdeci">double t0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00127">local_planner.cpp:127</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a18664faefb17400b465a3a21051f922e"><div class="ttname"><a href="local__planner_8cpp.html#a18664faefb17400b465a3a21051f922e">cl_curve_scaling</a></div><div class="ttdeci">#define cl_curve_scaling</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00046">local_planner.cpp:46</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a781b99a6d9fefd69ab171d5a11b5c641"><div class="ttname"><a href="local__planner_8cpp.html#a781b99a6d9fefd69ab171d5a11b5c641">cl_straight_scale</a></div><div class="ttdeci">#define cl_straight_scale</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00047">local_planner.cpp:47</a></div></div>
<div class="ttc" id="classobstacle_html_a74686cda8e6308255dc0d4e8ee6e3594"><div class="ttname"><a href="classobstacle.html#a74686cda8e6308255dc0d4e8ee6e3594">obstacle::obs_counter</a></div><div class="ttdeci">static int obs_counter</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00111">local_planner.cpp:111</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a4d4afce9a47092986794487862ec7de9"><div class="ttname"><a href="local__planner_8cpp.html#a4d4afce9a47092986794487862ec7de9">prev_global_theta_x</a></div><div class="ttdeci">double prev_global_theta_x</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00105">local_planner.cpp:105</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a8cde6b75086d15fe95bef8b3a991a552"><div class="ttname"><a href="local__planner_8cpp.html#a8cde6b75086d15fe95bef8b3a991a552">imu_callback</a></div><div class="ttdeci">void imu_callback(const sensor_msgs::Imu::ConstPtr &amp;imu_msg)</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00147">local_planner.cpp:147</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ae076e0f69bb159c23ba2de859ffd9b0e"><div class="ttname"><a href="local__planner_8cpp.html#ae076e0f69bb159c23ba2de859ffd9b0e">velocity_msg</a></div><div class="ttdeci">geometry_msgs::Twist velocity_msg</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00076">local_planner.cpp:76</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a592bf576ad56604781783a459d7725e4"><div class="ttname"><a href="local__planner_8cpp.html#a592bf576ad56604781783a459d7725e4">cl_pt_indices</a></div><div class="ttdeci">int cl_pt_indices</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00102">local_planner.cpp:102</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ab38a15ef1101eb9b7faea6ead4efa4e1"><div class="ttname"><a href="local__planner_8cpp.html#ab38a15ef1101eb9b7faea6ead4efa4e1">get_obstacle_sd</a></div><div class="ttdeci">void get_obstacle_sd()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00765">local_planner.cpp:765</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a2871a1979bfda417aeb0da473e54ce00"><div class="ttname"><a href="local__planner_8cpp.html#a2871a1979bfda417aeb0da473e54ce00">s1</a></div><div class="ttdeci">double s1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a1d37c710aae6c108f6ce2e40bf4df2f4"><div class="ttname"><a href="local__planner_8cpp.html#a1d37c710aae6c108f6ce2e40bf4df2f4">get_current_statedata</a></div><div class="ttdeci">void get_current_statedata()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00540">local_planner.cpp:540</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a58b266028d86225355409f607b437902"><div class="ttname"><a href="local__planner_8cpp.html#a58b266028d86225355409f607b437902">set_loop_rate</a></div><div class="ttdeci">#define set_loop_rate</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00057">local_planner.cpp:57</a></div></div>
<div class="ttc" id="classsd__traj_html_a66583169c4cc63d6fe9a47c651ff76d7"><div class="ttname"><a href="classsd__traj.html#a66583169c4cc63d6fe9a47c651ff76d7">sd_traj::traj_counter</a></div><div class="ttdeci">static int traj_counter</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00125">local_planner.cpp:125</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ad59b5ced5ff0c0b46657b0fcaf1596b7"><div class="ttname"><a href="local__planner_8cpp.html#ad59b5ced5ff0c0b46657b0fcaf1596b7">d0</a></div><div class="ttdeci">double d0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_af4bb5f2901e6819e873fcbae218e14ee"><div class="ttname"><a href="local__planner_8cpp.html#af4bb5f2901e6819e873fcbae218e14ee">publish_vw</a></div><div class="ttdeci">void publish_vw(int x)</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00251">local_planner.cpp:251</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a7472b1780d9c3201ab1aa86ff5d34542"><div class="ttname"><a href="local__planner_8cpp.html#a7472b1780d9c3201ab1aa86ff5d34542">vd0</a></div><div class="ttdeci">double vd0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a2f80386f2f64ce19285c9e4244fd05ee"><div class="ttname"><a href="local__planner_8cpp.html#a2f80386f2f64ce19285c9e4244fd05ee">max_robot_curvature</a></div><div class="ttdeci">#define max_robot_curvature</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00037">local_planner.cpp:37</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a2a6d90c736b9e880fad815952157136f"><div class="ttname"><a href="local__planner_8cpp.html#a2a6d90c736b9e880fad815952157136f">t0</a></div><div class="ttdeci">double t0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a919dc6c875b86427c935889488d8f2db"><div class="ttname"><a href="local__planner_8cpp.html#a919dc6c875b86427c935889488d8f2db">get_global_waypoints</a></div><div class="ttdeci">void get_global_waypoints()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00327">local_planner.cpp:327</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a4c8219ede1ade27a41eef17179b45fdc"><div class="ttname"><a href="local__planner_8cpp.html#a4c8219ede1ade27a41eef17179b45fdc">global_theta_x</a></div><div class="ttdeci">double global_theta_x[(int) cl_traj_pt]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00098">local_planner.cpp:98</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a4c5705f992c466f8c0b7168ecb27c104"><div class="ttname"><a href="local__planner_8cpp.html#a4c5705f992c466f8c0b7168ecb27c104">global_omega</a></div><div class="ttdeci">double global_omega[(int) cl_traj_pt]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00098">local_planner.cpp:98</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a46054cbb947704d9013f6eea7c52a351"><div class="ttname"><a href="local__planner_8cpp.html#a46054cbb947704d9013f6eea7c52a351">obstacle_local_distance</a></div><div class="ttdeci">float obstacle_local_distance[100]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00081">local_planner.cpp:81</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aff0fb1a480bc0760f5f17155bef9b250"><div class="ttname"><a href="local__planner_8cpp.html#aff0fb1a480bc0760f5f17155bef9b250">as0</a></div><div class="ttdeci">double as0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a5f1d9a9d1dea75c04366353ebaac18c6"><div class="ttname"><a href="local__planner_8cpp.html#a5f1d9a9d1dea75c04366353ebaac18c6">cl_traj_pt</a></div><div class="ttdeci">#define cl_traj_pt</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00050">local_planner.cpp:50</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_acfc0857e5702abe996d2a0bb34d0f86e"><div class="ttname"><a href="local__planner_8cpp.html#acfc0857e5702abe996d2a0bb34d0f86e">robot_current_yaw</a></div><div class="ttdeci">double robot_current_yaw</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00088">local_planner.cpp:88</a></div></div>
<div class="ttc" id="classsd__traj_html_adf22f8c8b4074ee21c09c43966d42cfb"><div class="ttname"><a href="classsd__traj.html#adf22f8c8b4074ee21c09c43966d42cfb">sd_traj::ds</a></div><div class="ttdeci">double ds[200]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00133">local_planner.cpp:133</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a51907f76c1d1b4db1d09d501e4d9633e"><div class="ttname"><a href="local__planner_8cpp.html#a51907f76c1d1b4db1d09d501e4d9633e">replanning_freq</a></div><div class="ttdeci">#define replanning_freq</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00058">local_planner.cpp:58</a></div></div>
<div class="ttc" id="classobstacle_html_a9d51607bab73a6ad332ef4f9d8ce1a83"><div class="ttname"><a href="classobstacle.html#a9d51607bab73a6ad332ef4f9d8ce1a83">obstacle::vd</a></div><div class="ttdeci">double vd</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a4e8c301f990fd72fe87a6d928bcfd60a"><div class="ttname"><a href="local__planner_8cpp.html#a4e8c301f990fd72fe87a6d928bcfd60a">d1</a></div><div class="ttdeci">double d1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a538508598478b54f1b6507b871738c44"><div class="ttname"><a href="local__planner_8cpp.html#a538508598478b54f1b6507b871738c44">cl_way_pt</a></div><div class="ttdeci">Vector2d cl_way_pt[cl_way_pt_no]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00092">local_planner.cpp:92</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a5298273aac03e72f5f5c39a01e08aa5f"><div class="ttname"><a href="local__planner_8cpp.html#a5298273aac03e72f5f5c39a01e08aa5f">publish_marker_loop</a></div><div class="ttdeci">void publish_marker_loop()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00831">local_planner.cpp:831</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a59692051ca9586d10f35f14d574229da"><div class="ttname"><a href="local__planner_8cpp.html#a59692051ca9586d10f35f14d574229da">t1</a></div><div class="ttdeci">double t1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ad873ba305d44946ee75409224584033e"><div class="ttname"><a href="local__planner_8cpp.html#ad873ba305d44946ee75409224584033e">temp_pose_msg</a></div><div class="ttdeci">nav_msgs::Odometry temp_pose_msg</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00075">local_planner.cpp:75</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aa2bd94909649b162eb2e7efd31f69726"><div class="ttname"><a href="local__planner_8cpp.html#aa2bd94909649b162eb2e7efd31f69726">max_robot_velocity</a></div><div class="ttdeci">#define max_robot_velocity</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00038">local_planner.cpp:38</a></div></div>
<div class="ttc" id="classobstacle_html_adf74bb0e3b4f7517504b80a43a5742b6"><div class="ttname"><a href="classobstacle.html#adf74bb0e3b4f7517504b80a43a5742b6">obstacle::center_d</a></div><div class="ttdeci">double center_d</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="classsd__traj_html_af37e4caff69fab3384170eacefa9df99"><div class="ttname"><a href="classsd__traj.html#af37e4caff69fab3384170eacefa9df99">sd_traj::t1</a></div><div class="ttdeci">double t1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00127">local_planner.cpp:127</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aa191aa5ac56db5aa289e6e9289b6c043"><div class="ttname"><a href="local__planner_8cpp.html#aa191aa5ac56db5aa289e6e9289b6c043">get_center_line</a></div><div class="ttdeci">void get_center_line()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00342">local_planner.cpp:342</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a7e1475843f14f68802e265de51cfe676"><div class="ttname"><a href="local__planner_8cpp.html#a7e1475843f14f68802e265de51cfe676">arc_length</a></div><div class="ttdeci">double arc_length[(int)(cl_traj_pt)]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00094">local_planner.cpp:94</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a2e01fee1e60f4e09b54edd80db24d8a8"><div class="ttname"><a href="local__planner_8cpp.html#a2e01fee1e60f4e09b54edd80db24d8a8">vd1</a></div><div class="ttdeci">double vd1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="classsd__traj_html"><div class="ttname"><a href="classsd__traj.html">sd_traj</a></div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00122">local_planner.cpp:122</a></div></div>
<div class="ttc" id="classsd__traj_html_a2ad27c40ed52f6c4fed91acfab28a8a0"><div class="ttname"><a href="classsd__traj.html#a2ad27c40ed52f6c4fed91acfab28a8a0">sd_traj::b_mat</a></div><div class="ttdeci">MatrixXd b_mat</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00128">local_planner.cpp:128</a></div></div>
<div class="ttc" id="classsd__traj_html_a5161707d715d7008c43ceb8db33d3324"><div class="ttname"><a href="classsd__traj.html#a5161707d715d7008c43ceb8db33d3324">sd_traj::st</a></div><div class="ttdeci">double st[200]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00133">local_planner.cpp:133</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a627702d2f23682cfec7940631a5bc9fb"><div class="ttname"><a href="local__planner_8cpp.html#a627702d2f23682cfec7940631a5bc9fb">robot_current_d</a></div><div class="ttdeci">double robot_current_d</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00089">local_planner.cpp:89</a></div></div>
<div class="ttc" id="classsd__traj_html_a1e36520042478700368a302660e1f62e"><div class="ttname"><a href="classsd__traj.html#a1e36520042478700368a302660e1f62e">sd_traj::max_curvature_status</a></div><div class="ttdeci">bool max_curvature_status</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00131">local_planner.cpp:131</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a2f33a93de7f5b3d170771dba8157d46a"><div class="ttname"><a href="local__planner_8cpp.html#a2f33a93de7f5b3d170771dba8157d46a">cl_dt</a></div><div class="ttdeci">#define cl_dt</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00048">local_planner.cpp:48</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aef8dc9d0b4c26170f6a0eda9862dc616"><div class="ttname"><a href="local__planner_8cpp.html#aef8dc9d0b4c26170f6a0eda9862dc616">check_curvature_convert2vw</a></div><div class="ttdeci">void check_curvature_convert2vw()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l01068">local_planner.cpp:1068</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ac5e9d55d8f2ce48db1da6d095e09b6e9"><div class="ttname"><a href="local__planner_8cpp.html#ac5e9d55d8f2ce48db1da6d095e09b6e9">traj_s1</a></div><div class="ttdeci">#define traj_s1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00062">local_planner.cpp:62</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a9ea6848b334fd0251ad7adc896668f86"><div class="ttname"><a href="local__planner_8cpp.html#a9ea6848b334fd0251ad7adc896668f86">optimum_traj_no</a></div><div class="ttdeci">int optimum_traj_no</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00097">local_planner.cpp:97</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a235458d2aeaae922a1288e53cba76953"><div class="ttname"><a href="local__planner_8cpp.html#a235458d2aeaae922a1288e53cba76953">obs</a></div><div class="ttdeci">obstacle obs[100]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00120">local_planner.cpp:120</a></div></div>
<div class="ttc" id="classobstacle_html_a59d16623cad9abb1fa5d2b34c7ec9d38"><div class="ttname"><a href="classobstacle.html#a59d16623cad9abb1fa5d2b34c7ec9d38">obstacle::transformed_x</a></div><div class="ttdeci">double transformed_x</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a8c6450fd8fb5527af2c098cf4ea0f71d"><div class="ttname"><a href="local__planner_8cpp.html#a8c6450fd8fb5527af2c098cf4ea0f71d">robot_current_y</a></div><div class="ttdeci">double robot_current_y</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00088">local_planner.cpp:88</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_addef6f87b5a64ce67827031398bc1071"><div class="ttname"><a href="local__planner_8cpp.html#addef6f87b5a64ce67827031398bc1071">robot_current_x</a></div><div class="ttdeci">double robot_current_x</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00088">local_planner.cpp:88</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a68e0d3aaf643ea37de6e743cc0d04296"><div class="ttname"><a href="local__planner_8cpp.html#a68e0d3aaf643ea37de6e743cc0d04296">vs0</a></div><div class="ttdeci">double vs0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a834d942b572ceb537c64d3ab9f55ccc6"><div class="ttname"><a href="local__planner_8cpp.html#a834d942b572ceb537c64d3ab9f55ccc6">sort_low_cost</a></div><div class="ttdeci">bool sort_low_cost(sd_traj &amp;traj_a, sd_traj &amp;traj_b)</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l01008">local_planner.cpp:1008</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_afb1d2a91a6dd407bd6a80859febf512e"><div class="ttname"><a href="local__planner_8cpp.html#afb1d2a91a6dd407bd6a80859febf512e">vis_pub</a></div><div class="ttdeci">ros::Publisher vis_pub</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00072">local_planner.cpp:72</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ac9d71ed62568c755562280c59cb04ae2"><div class="ttname"><a href="local__planner_8cpp.html#ac9d71ed62568c755562280c59cb04ae2">robot_current_s</a></div><div class="ttdeci">double robot_current_s</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00089">local_planner.cpp:89</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a7f06f872d793c750223d5259fc3d49ed"><div class="ttname"><a href="local__planner_8cpp.html#a7f06f872d793c750223d5259fc3d49ed">as1</a></div><div class="ttdeci">double as1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="classobstacle_html_ae1111180c38a0319eb55a872555c17b3"><div class="ttname"><a href="classobstacle.html#ae1111180c38a0319eb55a872555c17b3">obstacle::center_s</a></div><div class="ttdeci">double center_s</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aa6fcf1cd7ebd1fec3845682d654b63ad"><div class="ttname"><a href="local__planner_8cpp.html#aa6fcf1cd7ebd1fec3845682d654b63ad">theta_r</a></div><div class="ttdeci">double theta_r[(int)(cl_traj_pt)]</div><div class="ttdoc">center line trajectory (x,y) </div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00094">local_planner.cpp:94</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a90bc79e319d8220cc2009aaa45241183"><div class="ttname"><a href="local__planner_8cpp.html#a90bc79e319d8220cc2009aaa45241183">obstacle_radius</a></div><div class="ttdeci">float obstacle_radius[100]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00081">local_planner.cpp:81</a></div></div>
<div class="ttc" id="classsd__traj_html_a8240ad9000f59ccc9f6b270db19a74d2"><div class="ttname"><a href="classsd__traj.html#a8240ad9000f59ccc9f6b270db19a74d2">sd_traj::c_b_mat</a></div><div class="ttdeci">MatrixXd c_b_mat</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00128">local_planner.cpp:128</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a6143e13533a935072ba67bc8d76a4160"><div class="ttname"><a href="local__planner_8cpp.html#a6143e13533a935072ba67bc8d76a4160">kappa</a></div><div class="ttdeci">double kappa[(int)(cl_traj_pt)]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00094">local_planner.cpp:94</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ae3fbacc63c14ca90fa6c0047dd75d1be"><div class="ttname"><a href="local__planner_8cpp.html#ae3fbacc63c14ca90fa6c0047dd75d1be">accn_msg</a></div><div class="ttdeci">sensor_msgs::Imu accn_msg</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00073">local_planner.cpp:73</a></div></div>
<div class="ttc" id="classsd__traj_html_a875b3cb074ab67e14130e2f7f230a66c"><div class="ttname"><a href="classsd__traj.html#a875b3cb074ab67e14130e2f7f230a66c">sd_traj::a_mat</a></div><div class="ttdeci">MatrixXd a_mat</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00128">local_planner.cpp:128</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aa4f3e8cdd84772718af1bb4b180ab348"><div class="ttname"><a href="local__planner_8cpp.html#aa4f3e8cdd84772718af1bb4b180ab348">last_plan</a></div><div class="ttdeci">bool last_plan</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00103">local_planner.cpp:103</a></div></div>
<div class="ttc" id="classobstacle_html_a9ab8279f395a82eed17ea20976cd19bb"><div class="ttname"><a href="classobstacle.html#a9ab8279f395a82eed17ea20976cd19bb">obstacle::vs</a></div><div class="ttdeci">double vs</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_ad6d95303034671dc736a4bc1f27dd035"><div class="ttname"><a href="local__planner_8cpp.html#ad6d95303034671dc736a4bc1f27dd035">ad1</a></div><div class="ttdeci">double ad1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_aa857ed5c081381af534715a410da6fa3"><div class="ttname"><a href="local__planner_8cpp.html#aa857ed5c081381af534715a410da6fa3">s0</a></div><div class="ttdeci">double s0</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a5bc1b5031f5246c44954e0621b9273ab"><div class="ttname"><a href="local__planner_8cpp.html#a5bc1b5031f5246c44954e0621b9273ab">check_collision</a></div><div class="ttdeci">void check_collision()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00902">local_planner.cpp:902</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a6491a7e652ea9b773cad384904a81f4c"><div class="ttname"><a href="local__planner_8cpp.html#a6491a7e652ea9b773cad384904a81f4c">odom_scan_callback</a></div><div class="ttdeci">void odom_scan_callback(const nav_msgs::Odometry::ConstPtr &amp;odom_msg, const sensor_msgs::LaserScan::ConstPtr &amp;scan_msg)</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00154">local_planner.cpp:154</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="local__planner_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l01233">local_planner.cpp:1233</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_acb4e26b36672e56fc305cfd20b772d2f"><div class="ttname"><a href="local__planner_8cpp.html#acb4e26b36672e56fc305cfd20b772d2f">compute_cost</a></div><div class="ttdeci">void compute_cost()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l01012">local_planner.cpp:1012</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a1748550d0030d6dbe5f7522171f4c06d"><div class="ttname"><a href="local__planner_8cpp.html#a1748550d0030d6dbe5f7522171f4c06d">obstacle_local_angle</a></div><div class="ttdeci">float obstacle_local_angle[100]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00081">local_planner.cpp:81</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a72b5c8c91d6a8dde0e0cf67b7e061796"><div class="ttname"><a href="local__planner_8cpp.html#a72b5c8c91d6a8dde0e0cf67b7e061796">global_y</a></div><div class="ttdeci">double global_y[(int) cl_traj_pt]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00098">local_planner.cpp:98</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a03e759d29bb6fd8fc920386e67f38b2e"><div class="ttname"><a href="local__planner_8cpp.html#a03e759d29bb6fd8fc920386e67f38b2e">obs_no</a></div><div class="ttdeci">int obs_no</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00080">local_planner.cpp:80</a></div></div>
<div class="ttc" id="classobstacle_html_a0d5fa2a59e2634782fa6e2021a769d33"><div class="ttname"><a href="classobstacle.html#a0d5fa2a59e2634782fa6e2021a769d33">obstacle::orientation</a></div><div class="ttdeci">double orientation</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a3d218019699439982d2661040d0106ca"><div class="ttname"><a href="local__planner_8cpp.html#a3d218019699439982d2661040d0106ca">vs1</a></div><div class="ttdeci">double vs1</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00084">local_planner.cpp:84</a></div></div>
<div class="ttc" id="classobstacle_html_a7189cf6ca75ab95b4ded044234935293"><div class="ttname"><a href="classobstacle.html#a7189cf6ca75ab95b4ded044234935293">obstacle::transformed_y</a></div><div class="ttdeci">double transformed_y</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00113">local_planner.cpp:113</a></div></div>
<div class="ttc" id="classsd__traj_html_afd326744d3573055c439650ddffd614b"><div class="ttname"><a href="classsd__traj.html#afd326744d3573055c439650ddffd614b">sd_traj::max_curvature_value</a></div><div class="ttdeci">double max_curvature_value</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00130">local_planner.cpp:130</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a9a2c88df8693626f0136f6181e63eea1"><div class="ttname"><a href="local__planner_8cpp.html#a9a2c88df8693626f0136f6181e63eea1">exec_t_step</a></div><div class="ttdeci">double exec_t_step</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00100">local_planner.cpp:100</a></div></div>
<div class="ttc" id="classobstacle_html_a35e495dba687ff53be20bfe1ddac57a6"><div class="ttname"><a href="classobstacle.html#a35e495dba687ff53be20bfe1ddac57a6">obstacle::obstacle</a></div><div class="ttdeci">obstacle()</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00115">local_planner.cpp:115</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_a7daa551a0ff87c801434a361661ab18a"><div class="ttname"><a href="local__planner_8cpp.html#a7daa551a0ff87c801434a361661ab18a">traj</a></div><div class="ttdeci">sd_traj traj[vs1_var *d1_var]</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00141">local_planner.cpp:141</a></div></div>
<div class="ttc" id="local__planner_8cpp_html_abc05df855ddc66c6c6c6b92f28ca12a1"><div class="ttname"><a href="local__planner_8cpp.html#abc05df855ddc66c6c6c6b92f28ca12a1">d1_var</a></div><div class="ttdeci">#define d1_var</div><div class="ttdef"><b>Definition:</b> <a href="local__planner_8cpp_source.html#l00053">local_planner.cpp:53</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/local_planner">local_planner</a><br />
Author(s): </br />
<small>autogenerated on Fri Jul 27 2018 16:02:36</small>
</div>
</body>
</html>
